<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>Makoshan` Blog</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description">
<meta property="og:type" content="website">
<meta property="og:title" content="Makoshan` Blog">
<meta property="og:url" content="http://makohill.github.io/page/2/index.html">
<meta property="og:site_name" content="Makoshan` Blog">
<meta property="og:description">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Makoshan` Blog">
<meta name="twitter:description">
  
    <link rel="alternate" href="/atom.xml" title="Makoshan` Blog" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="/home/thrusday/workspace/makohill.github.io/public/css/style.css">
  

</head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/home/thrusday/workspace/makohill.github.io/public/" id="logo">Makoshan` Blog</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/home/thrusday/workspace/makohill.github.io/public/">Home</a>
        
          <a class="main-nav-link" href="/home/thrusday/workspace/makohill.github.io/public/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" results="0" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://makohill.github.io"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main">
  
    <article id="post-Tool/Sublime Text2不自动打开最近的项目" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/home/thrusday/workspace/makohill.github.io/public/2016/04/20/Tool/Sublime Text2不自动打开最近的项目/" class="article-date">
  <time datetime="2016-04-20T14:59:39.301Z" itemprop="datePublished">2016-04-20</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>Title: Sublime Text2不自动打开最近的项目<br>Date: 2013-03-06 20:41:47<br>tags:Tool</p>
<p>1.首选项<br>2.用户设置添加两行</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">	&quot;hot_exit&quot;: false, </span><br><span class="line">    &quot;remember_open_files&quot;: false,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这两个值改成false就可以了</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://makohill.github.io/home/thrusday/workspace/makohill.github.io/public/2016/04/20/Tool/Sublime Text2不自动打开最近的项目/" data-id="cin8zn6kc001ajtxuyd7etvz3" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-Tool/Ubuntu怎么样复制文件夹下所有内容到另一个文件夹" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/home/thrusday/workspace/makohill.github.io/public/2016/04/20/Tool/Ubuntu怎么样复制文件夹下所有内容到另一个文件夹/" class="article-date">
  <time datetime="2016-04-20T14:59:39.301Z" itemprop="datePublished">2016-04-20</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>Title: Ubuntu怎么样复制文件夹下所有内容到另一个文件夹<br>Date: 2014-07-2 12:32:53<br>格式：cp -Rf 原路径/ 目的路径/<br>例如：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cp -Rf /home/makoshan/* /root/temp/</span><br></pre></td></tr></table></figure></p>
<p>将 /home/makoshan目录下的所有东西拷到/root/temp/下而不拷贝makoshan目录本身。<br>注释：</p>
<blockquote>
<p>-r 递归复制该目录下所有的子目录和文件<br>-R 递归复制，复制文件夹下面的内容<br>-f 强行复制<br>-v 显示执行过程</p>
</blockquote>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://makohill.github.io/home/thrusday/workspace/makohill.github.io/public/2016/04/20/Tool/Ubuntu怎么样复制文件夹下所有内容到另一个文件夹/" data-id="cin8zn6kj001bjtxu1p9c9ga3" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-Tool/Wordpress for bae-安装教程" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/home/thrusday/workspace/makohill.github.io/public/2016/04/20/Tool/Wordpress for bae-安装教程/" class="article-date">
  <time datetime="2016-04-20T14:59:39.301Z" itemprop="datePublished">2016-04-20</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>Title: Wordpress for bae-安装教程</p>
<p>Date: 2013-09-09 21:08:29</p>
<p>Tag:Tool</p>
<p>URL: /archives/1138</p>
<p><img src="http://m2.img.libdd.com/farm5/2013/0926/15/6C618B1808364CC0059FB02569C1828DBB283D5FDDCDB_500_231.jpg" alt="" title="百度云"></p>
<p>一、安装的前提条件</p>
<p>1、在BAE申请至少一个云数据库。</p>
<p>2、在BAE云存储上创建至少一个Bucket。如果你不用wordpress上传图片，视频等资源的话，可以不要。但我们</p>
<p>推荐你使用。</p>
<p>二、安装步骤</p>
<p>1、把wordpress下载到本地电脑，解压之后，打开wordpress根目录下的文件wp-config.php，并做如下修改：</p>
<p>a、把$dbname修改为你在云平台上申请的数据库的名字(建议为你的wordpress单独申请一个数据库, 并且该数据库</p>
<p>的字符集设置为utf8，不然博客安装之后会产生乱码的问题)；</p>
<p>b、$table_prefix是wordpress在数据库$dbname里创建的数据表的名字的前缀(你可以任意填写一个你喜欢的名字， 例如i_like_bae)。</p>
<p>c、$bcs_bukect填写一个你在云平台上创建的一个bucket的值，注意你必须先创建bucekt。</p>
<p>2、接下来把wordpress当做一个你的一个php应用部署到BAE上就可以安装了。如果你对怎么在BAE上部署应用还不是很清楚，也</p>
<p>可以查看下面的示例。</p>
<p>a、进入你解压后的wordpress的根目录，全选该目录下的文件，右键点击添加到压缩文件，把该目录下的所有文件添加到压缩</p>
<p>一个文件，设为wordpress.zip。</p>
<p>b、访问<a href="http://developer.baidu.com/，然后点击创建应用，这时会弹出一个框。" target="_blank" rel="external">http://developer.baidu.com/，然后点击创建应用，这时会弹出一个框。</a></p>
<p>c、应用名称填写”i-like-bae”（填写的时候记得别填双引号），域名填写”ilikebae”(实际的域名会将”.duapp.com”作为后缀)。</p>
<p>d、环境类型选择”PHP”。</p>
<p>e、然后点击确定，这时会跳转到引用信息页。</p>
<p>f、在左侧栏点击“版本管理”，这时进入“版本管理页”。</p>
<p>g、点击创建新版本，这时弹出一个框。</p>
<p>h、在“请输入版本号”里输入一个0-19的数字作为版本号，假设输入了“0”。勾选“上传php代码包”，然后点击“选择文件”，</p>
<p>选择刚刚压缩的文件wordpress.zip，然后点击保存。保存之后BAE会把你上传代码，解压代码并部署代码，这里需要一点时间。</p>
<p>i、当刚刚上传的版本显示“已发布”，点击0号版本左边的方框生效该版本。当0号版本的状态显示为“已上线”，查看0号版本的代码，</p>
<p>这时就进入了wordpress的安装步骤。</p>
<p>三、尚无法使用的功能</p>
<p>1、安装主题和插件，这两个功能都需要有登陆站点所在服务器的用户名和密码，暂时不支持，建议</p>
<p>用户把想要安装的主题或者插件放到wordpress的相应目录下再上传wordpress。具体的事宜需要查看</p>
<p>wordpress的官网信息了。</p>
<p>2、图片上传之后无法对图片进行编辑，如果点击”编辑图像”的话，将会提示图</p>
<p>像不存在的问题，不过不用担心，实际上图片已经上传到云存储了。</p>
<p>3、上传的图片暂时无法附加到文章，但可以在编辑文章的时候向文章中插入图片。</p>
<p>四、常见问题处理</p>
<p>1、安装后你去访问你的wordpress，可能会出现“建立数据库连接时出错”的错误，这时需要检查下你的数据库名是否填写</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://makohill.github.io/home/thrusday/workspace/makohill.github.io/public/2016/04/20/Tool/Wordpress for bae-安装教程/" data-id="cin8zn6kk001cjtxuxlqr0l7w" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-Tool/使用ROME解析RSS" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/home/thrusday/workspace/makohill.github.io/public/2016/04/20/Tool/使用ROME解析RSS/" class="article-date">
  <time datetime="2016-04-20T14:59:39.301Z" itemprop="datePublished">2016-04-20</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>Title: 使用ROME解析RSS<br>Date: 2014-03-23 21:56:45<br>Tag:Tool</p>
<p>最近做一个项目，需要解析数据量很大RSS，所以深度整理类一下资料。</p>
<p>####RSS标准<br>RSS标准比较混乱，主要有以下3个系列</p>
<ul>
<li>RSS 0.9x / 2.0 : RSS技术诞生于1999年的网景公司(Netscape)，其发布了一个0.9版本的规范。2001年，RSS技术标准的发展工作被Userland Software公司的戴夫 温那(Dave Winer)所接手。陆续发布了0.9x的系列版本。当W3C小组发布RSS 1.0后，Dave Winer不承认其有效性。并于2002年9月独自把RSS升级到了2.0版本(Really Simple Syndication)，并交由哈佛大学Technology at Harvard Law进行维护。</li>
<li>RSS 1.0 : 在RSS发展过程中，为使RSS成为一个通用的规范，并进一步标准化。一个联合小组根据W3C新一代的Resource Description Framework  (RDF) 对RSS进行了重新定义，发布了RSS 1.0版，并把RSS定义为“RDF Site Summary”。现在RSS 1.0版由W3C联合小组维护。</li>
<li>Atom : Atom是一个项目的名字，主要是开发一个新的博客摘要格式以解决目前RSS存在的问题(混乱的版本号，不是一个真正的开放标准，表示方法的不一致，定义贫乏等等)。</li>
</ul>
<p>####如何实现RSS<br>RSS标准虽然混乱，但是其本质都是XML文档。你可以只使用notepad, 按照某个RSS标准, 手写一个xml, 并提供给客户端。<br>现在也有许多开源项目来提供RSS的解决方案。<br>Rome:<a href="https://rome.dev.java.net/" target="_blank" rel="external">https://rome.dev.java.net/</a><br>RSSLibJ :<a href="http://enigmastation.com/rsslibj/" target="_blank" rel="external">http://enigmastation.com/rsslibj/</a><br>RSSLib4J: <a href="http://devzone.stealthp.org/cms/index.php?page=RSSLib4J" target="_blank" rel="external">http://devzone.stealthp.org/cms/index.php?page=RSSLib4J</a><br>使用这些解决方案可以更方便的处理RSS.</p>
<p>####用 ROME 实现 RSS 服务<br>ROME是一个基于Java的开源程序包。ROME提供了一组Atom/RSS工具类，以使得用Java可以更方便和快捷的来操作大部分Syndication格式数据。使用ROME的解析器对读取一个Feed的操作是非常简单的，解析器可以从一个网址、一个本地文件或文件流中读取转换数据。将RSS子项列表信息以表格的形式显示出关键的几项，如标题、链接地址、标题简介。同时，ROME可以直接操作SyndFeed来构造Feed数据，实现从一个存在的Feed地址里读取解析到再输出生成一个Feed的过程。更多信息请参考该项目主页:    <a href="http://wiki.java.net/bin/view/Javawsxml/Rome" target="_blank" rel="external">http://wiki.java.net/bin/view/Javawsxml/Rome</a></p>
<p>####示例代码</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line">import com.sun.syndication.feed.synd.SyndCategory;</span><br><span class="line">import com.sun.syndication.feed.synd.SyndContent;</span><br><span class="line">import com.sun.syndication.feed.synd.SyndEnclosure;</span><br><span class="line">import com.sun.syndication.feed.synd.SyndEntry;</span><br><span class="line">import com.sun.syndication.feed.synd.SyndFeed;</span><br><span class="line">import com.sun.syndication.io.SyndFeedInput;</span><br><span class="line">import com.sun.syndication.io.XmlReader;</span><br><span class="line"></span><br><span class="line">public class TestParse &#123;</span><br><span class="line"> @Test</span><br><span class="line"> public void parseRss() &#123;</span><br><span class="line">  String rss =&quot;http://teahour.fm/feed.xml&quot;;</span><br><span class="line">  try &#123;</span><br><span class="line">   URL url = new URL(rss);</span><br><span class="line">   // 读取Rss源</span><br><span class="line">   XmlReader reader = new XmlReader(url);</span><br><span class="line">   System.out.println(&quot;Rss源的编码格式为：&quot; + reader.getEncoding());</span><br><span class="line">   SyndFeedInput input = new SyndFeedInput();</span><br><span class="line">   // 得到SyndFeed对象，即得到Rss源里的所有信息</span><br><span class="line">   SyndFeed feed = input.build(reader);</span><br><span class="line">   // 得到Rss新闻中子项列表</span><br><span class="line">   List entries = feed.getEntries();</span><br><span class="line">   // 循环得到每个子项信息</span><br><span class="line">   for (int i = 0; i &lt; entries.size(); i++) &#123;</span><br><span class="line">    SyndEntry entry = (SyndEntry) entries.get(i);</span><br><span class="line">    // 标题、连接地址、标题简介、时间是一个Rss源项最基本的组成部分</span><br><span class="line">    System.out.println(&quot;标题：&quot; + entry.getTitle());</span><br><span class="line">    System.out.println(&quot;连接地址：&quot; + entry.getLink());</span><br><span class="line">    SyndContent description = entry.getDescription();</span><br><span class="line">    System.out.println(&quot;标题简介：&quot; + description.getValue());</span><br><span class="line">    System.out.println(&quot;发布时间：&quot; + entry.getPublishedDate());</span><br><span class="line">    // 以下是Rss源可先的几个部分</span><br><span class="line">    System.out.println(&quot;标题的作者：&quot; + entry.getAuthor());</span><br><span class="line">    // 此标题所属的范畴</span><br><span class="line">    List categoryList = entry.getCategories();</span><br><span class="line">    if (categoryList != null) &#123;</span><br><span class="line">     for (int m = 0; m &lt; categoryList.size(); m++) &#123;</span><br><span class="line">      SyndCategory category = (SyndCategory) categoryList</span><br><span class="line">        .get(m);</span><br><span class="line">      System.out.println(&quot;此标题所属的范畴：&quot; + category.getName());</span><br><span class="line">     &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    // 得到流媒体播放文件的信息列表</span><br><span class="line">    List enclosureList = entry.getEnclosures();</span><br><span class="line">    if (enclosureList != null) &#123;</span><br><span class="line">     for (int n = 0; n &lt; enclosureList.size(); n++) &#123;</span><br><span class="line">      SyndEnclosure enclosure = (SyndEnclosure) enclosureList</span><br><span class="line">        .get(n);</span><br><span class="line">      System.out.println(&quot;流媒体播放文件：&quot; + entry.getEnclosures());</span><br><span class="line">     &#125;</span><br><span class="line">    &#125;</span><br><span class="line">   &#125;</span><br><span class="line">  &#125; catch (Exception e) &#123;</span><br><span class="line">   e.printStackTrace();</span><br><span class="line">  &#125;</span><br><span class="line"> &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://makohill.github.io/home/thrusday/workspace/makohill.github.io/public/2016/04/20/Tool/使用ROME解析RSS/" data-id="cin8zn6kn001djtxugfaryzlg" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-Tool/去你的城市" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/home/thrusday/workspace/makohill.github.io/public/2016/04/20/Tool/去你的城市/" class="article-date">
  <time datetime="2016-04-20T14:59:39.301Z" itemprop="datePublished">2016-04-20</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>Title: 去 你的城市<br>Date: 2014-06-02 09:28:07<br>Tag:Dayone</p>
<p>去年的信誓旦旦，在图书馆查阅大鹏。</p>
<p>如今我成为深圳渺小的蝼蚁，为工作忙碌。总以为上班以后，就能做更多的事情。太多没时间的借口。周末的早晨，没有计划，我坐上了去大鹏半岛的车，天很热，但心里在唱歌。</p>
<p><img src="/_image/2014-06-02/IMG_20140601_153954.jpg" alt="Image Title"><br>开满花的树下吃凉皮</p>
<p><img src="/_image/2014-06-02/IMG_20140601_154403.jpg" alt="Image Title"><br>放着曹方歌曲的石头青旅</p>
<p><img src="/_image/2014-06-02/IMG_20140601_160501.jpg" alt="Image Title"><br>或许你曾翻越山丘 看到不一样的风景</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://makohill.github.io/home/thrusday/workspace/makohill.github.io/public/2016/04/20/Tool/去你的城市/" data-id="cin8zn6kq001ejtxumxkij7mg" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-DayOne/如果你爱上太阳，该如何面对自己的阴影" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/home/thrusday/workspace/makohill.github.io/public/2016/04/20/DayOne/如果你爱上太阳，该如何面对自己的阴影/" class="article-date">
  <time datetime="2016-04-20T14:59:39.297Z" itemprop="datePublished">2016-04-20</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>Title: 如果你爱上太阳，该如何面对自己的阴影<br>Date: 2012-02-28 23:27:11<br>Tag:DayOne</p>
<p><img src="http://makoshan.u.qiniudn.com/xinlingbushou1.jpg" alt="心灵捕手12"></p>
<p>被人懂和每人懂都是一件好事。学过数学才能真正理解跟天才的差距啊。</p>
<p>###几段经典的台词</p>
<p>####treatment治疗 
　　 </p>
<ul>
<li>SEAN ：在失眠了大半夜的思索后，我突然想起了些东西，接着就沉沉入睡。你知道我当时想到什么吗？<br>　你只是个孩子，你根本不清楚你在说什么。<br>　　所以如果我问你艺术，你可能会提出艺术书籍中的粗浅论调，有关米开朗基罗，你知道很多，他的政治抱负、他和教皇…性向，所有作品，对吗？所以我敢打赌你说不出西斯汀教堂散发的气味，你从没站在真正站在那儿，仰头欣赏过它美丽的天花板。<br>　　如果问你女人，你八成会说出个人偏好的谬论，你可能上过几次床，但你说不出在女人身旁醒来的感觉，那是真正幸福的滋味。<br>　　如果问你战争，你大概会抛出莎士比亚的名言：“共赴战场吧，亲爱的朋友……”但你从没接近过战争，从没有把好友的头抱在膝盖上，看着他吐出最后一口气。<br>　　如果问你爱情，你会引述十四行诗，但你从没有因为看见一个女人而变得脆弱，知道有一个人能以双眼击倒你，她是上帝为你安排的天使，她能从地狱救出你，你不理解当她的天使的滋味，拥有对她的爱，直到永远。经历这一切，经历癌症。你无法体会在医院睡两个月，因为医生一看到你就知道，会客时间的规定对你无效。你不了解真正的失去，因为那只有当你有爱别人胜于自己才能体会。<br>　　可我怀疑你敢那样的去爱人。看着你，我没看到聪明自信，我看到被吓坏的狂妄孩子，但你是天才，没人能否认，没人能了解你的深度，但你看我的画就认定我，你把我的人生撕裂了。你是孤儿，对吧？你想我会知道你日子有多苦、你的感受、你是谁，是因为我看过孤雏泪吗？那简化你了吗？我不在乎，因为你知道吗？我不能靠任何书籍认识你，除非你谈自己，谈你是谁，那我就着迷了，我愿意加入，但你不想那么做，对吧？你为你可能会说的话而害怕。 
　　 
　　 <h4 id="about-Sean’s-wife妻子"><a href="#about-Sean’s-wife妻子" class="headerlink" title="about Sean’s wife妻子"></a>about Sean’s wife妻子</h4>　　 </li>
<li>SEAN ：我的妻子在世的时候有个毛病，一紧张就放屁。有一天晚上我妻子放屁把家里的狗都吵醒了，后来自己也醒了，还回头问我说：“是你吗？”我说：“是的，亲爱的，是我。”　　 </li>
<li>“是的，而且她一直以为是我。天哪，她去世两年了，而那是我记得的事。像那样的小事很奇妙，那是我最想念的事，这些小特点让她成为我太太。她也知道我所有的小瑕庛，人们称之为不完美。其实不然，那才是好东西，能选择让谁进入我们的世界。你并不完美，我不吊你胃口，你认识的女生也不完美，问题是你们是否完美地合适。亲密关系就是这么一回事，你可以知道全世界的事，但发掘的方法就是去尝试。你不能跟我这个糟老头学，就算我知道我也不告诉你。”<br>　　<br>　　<br>####National Security Agency 国家安全局 
　　 </li>
<li>Will：哦，那是你们的事情。你们掌握了80%的情报工作，你们有中央情报局的七倍那么大。 
　　 </li>
<li><p>NSA：我们不是来吹嘘那些的。</p>
</li>
<li><p>Will，在我看来，问题不是你为什么应该为国家安全局工作，而是你<br>为什么不呢？ 
　　 </p>
</li>
<li>Will：我为何不为国安局做事？这是个很难的问题。让我想想，若我做了，国安局会给我一些别人破解不了的密码。或许我试了，也破解了，我很满意，因为表现良好。但或许那个密码正式某个叛军基地的驻扎地……在北非或中东。你们发现后，就会轰炸叛军藏身之处，陌生的一千五百人因此丧命。然后，政客派特战部队防守该区。他们才不在乎，因为，被射杀的不是他们的子女。因为他们都加入了后备部队；而在那边中弹的南区孩子，回国后发现他们以前工作的工厂，现在转移到他去打仗的国家，害他中弹的敌人抢了他的饭碗——因为他一天的工资只需要一元。最后他发现，他会上战场，是为了得到该国的廉价原油，好让石油公司利用战争恐慌，抬高国内油价，小赚一番。但是，两块五一加仑有个屁用，他们得花时间把石油运回国内。或许还请了个酗酒的船长，他爱喝马丁尼，跟冰山玩滑雪，不久他撞上冰山，原油泄漏，杀光北大西洋的所有海洋生物。现在我朋友失业，也开不起车，他走路去面谈，很难受，因为炮弹片让他慢性出血；他也很饿，因为每次吃东西，唯一的特餐就是北大西洋鳕鱼。所以，你以为我会怎么想？我有个更好的点子。干！我干脆我把朋友干掉算了，把工作给敌人，抬高油价，轰炸村庄，猎杀小海豹，吸食大麻，加入后备部队。靠！我还可因此被选为总统！ </li>
</ul>
<p>####Chuckie 
　　 </p>
<ul>
<li>Chuckie： 那不是就可以离开这里了。
　　 </li>
<li>Will：为什么要离开？我想要一辈子住在这儿。和你做邻居,一起带着我们的儿子去打棒球。
　　 </li>
<li><p>Chuckie：听着，你是我的死党,这不会变的。但如果20年后你还住在这儿，还到我家看球赛,还在盖房子，我他妈的会杀了你。那不是恐吓,我会宰了你的。 　　</p>
</li>
<li><p>Will：你在胡扯什么? 　　 </p>
</li>
<li><p>Chuckie：听着，你有着我们都没有的天赋。
　　 </p>
</li>
<li>Will：拜托,为何大家都这么说？我辜负了自己吗？如果我自己本就不想有呢？ 　　 </li>
</ul>
<p>-　Chuckie：不…你没有对不起自己，是你对不起我。因为我明天醒来五十岁了，还在干这种事,无所谓，而你已拥有百万奖券，却窝囊的不敢兑现,狗屁。我会不惜一切交换你所拥有的，其他这些人也是。你再待20年是侮辱我们，窝在这里是浪费你时间。</p>
<ul>
<li><p>Will：你不懂。 　　</p>
</li>
<li><p>Chuckie：我告诉你我懂什么。我每天到你家接你，我们出去喝酒笑闹,那很棒。但我一天中最棒的时刻，只有十秒，从停车到你家门口，每次我敲门,都希望你不在了。不说再见,什么都没有，你就走了。我懂得不多,但我很清楚这一点。</p>
</li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://makohill.github.io/home/thrusday/workspace/makohill.github.io/public/2016/04/20/DayOne/如果你爱上太阳，该如何面对自己的阴影/" data-id="cin8zn6jq000xjtxu7xzwxepz" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-Android/如何禁止 DrawerLayout 来将触摸事件传递给基础视图" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/home/thrusday/workspace/makohill.github.io/public/2016/04/20/Android/如何禁止 DrawerLayout 来将触摸事件传递给基础视图/" class="article-date">
  <time datetime="2016-04-20T14:59:39.297Z" itemprop="datePublished">2016-04-20</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>Title: 如何禁止 DrawerLayout 来将触摸事件传递给基础视图<br>Date: 2014-02-28 21:32:45<br>Tag:Android</p>
<p>####问题描述：<br>在打开Drawer抽屉的情况下，点击抽屉界面，抽屉后面的的基础视图也会捕捉到点击事件。今天搞了一天终于解决了。</p>
<p>####解决方法 1：<br>重写基础视图的点击事件：<br>例如<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 重写监听事件</span></span><br><span class="line">        lv.setOnTouchListener(<span class="keyword">new</span> OnTouchListener() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">onTouch</span><span class="params">(View v, MotionEvent event)</span> </span>&#123;</span><br><span class="line">                Activity act = getActivity();</span><br><span class="line">                <span class="keyword">if</span> (act <span class="keyword">instanceof</span> MainActivity) &#123;</span><br><span class="line">                    <span class="keyword">final</span> <span class="keyword">boolean</span> canScroll = ((MainActivity) act).canScroll();</span><br><span class="line">                    Log.e(<span class="string">"scroll"</span>, <span class="string">""</span> + canScroll);</span><br><span class="line">                    <span class="keyword">if</span> (!canScroll) &#123;</span><br><span class="line">                        event.setAction(MotionEvent.ACTION_CANCEL);</span><br><span class="line">                        <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">                    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                        <span class="keyword">return</span> v.onTouchEvent(event);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">在基类中获取抽屉的状态</span><br><span class="line">    <span class="comment">// listview是否可以滑动</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">canScroll</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> isCanAccessFocus;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="keyword">private</span> <span class="keyword">boolean</span> isCanAccessFocus=<span class="keyword">true</span>;<span class="comment">//抽屉是否打开，打开就将设置为false</span></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onDrawerOpened</span><span class="params">(View arg0)</span> </span>&#123;</span><br><span class="line">                System.out.println(<span class="string">"抽屉打开"</span>);</span><br><span class="line">                isCanAccessFocus=<span class="keyword">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onDrawerClosed</span><span class="params">(View arg0)</span> </span>&#123;</span><br><span class="line">                System.out.println(<span class="string">"抽屉关闭"</span>);</span><br><span class="line">                isCanAccessFocus=<span class="keyword">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">drawerLayout.setDrawerListener(<span class="keyword">new</span> DrawerListener() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onDrawerStateChanged</span><span class="params">(<span class="keyword">int</span> arg0)</span> </span>&#123;</span><br><span class="line">                <span class="keyword">if</span> (arg0 == <span class="number">2</span>) &#123;</span><br><span class="line">                    System.out.println(arg0 + <span class="string">"抽屉打开"</span>);</span><br><span class="line">                &#125; <span class="keyword">else</span> <span class="keyword">if</span> (arg0 == <span class="number">0</span>) &#123;</span><br><span class="line">                    </span><br><span class="line">                    System.out.println(arg0 + <span class="string">"抽屉关闭"</span>);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onDrawerSlide</span><span class="params">(View arg0, <span class="keyword">float</span> arg1)</span> </span>&#123;</span><br><span class="line">            &#125;;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onDrawerOpened</span><span class="params">(View arg0)</span> </span>&#123;</span><br><span class="line">                isCanAccessFocus = <span class="keyword">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onDrawerClosed</span><span class="params">(View arg0)</span> </span>&#123;</span><br><span class="line">                isCanAccessFocus = <span class="keyword">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br></pre></td></tr></table></figure></p>
<p>####解决方法 2:<br>在抽屉里的内容-上设置为 true 可点击它就会消耗的触摸。<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">android.support.v4.widget.DrawerLayout</span></span><br><span class="line">    <span class="attr">xmlns:android</span>=<span class="string">"http://schemas.android.com/apk/res/android"</span></span><br><span class="line">    <span class="attr">android:id</span>=<span class="string">"@+id/drawer_layout"</span></span><br><span class="line">    <span class="attr">android:layout_width</span>=<span class="string">"match_parent"</span></span><br><span class="line">    <span class="attr">android:layout_height</span>=<span class="string">"match_parent"</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;<span class="name">FrameLayout</span></span><br><span class="line">        <span class="attr">android:id</span>=<span class="string">"@+id/content"</span></span><br><span class="line">        <span class="attr">android:layout_width</span>=<span class="string">"wrap_content"</span></span><br><span class="line">        <span class="attr">android:layout_height</span>=<span class="string">"wrap_content"</span>/&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;<span class="name">FrameLayout</span></span><br><span class="line">        <span class="attr">android:id</span>=<span class="string">"@+id/sidebar_container"</span></span><br><span class="line">        <span class="attr">android:layout_width</span>=<span class="string">"300dp"</span></span><br><span class="line">        <span class="attr">android:clickable</span>=<span class="string">"true"</span></span><br><span class="line">        <span class="attr">android:layout_height</span>=<span class="string">"match_parent"</span></span><br><span class="line">        <span class="attr">android:layout_gravity</span>=<span class="string">"left"</span>/&gt;</span></span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;/<span class="name">android.support.v4.widget.DrawerLayout</span>&gt;</span></span><br></pre></td></tr></table></figure></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://makohill.github.io/home/thrusday/workspace/makohill.github.io/public/2016/04/20/Android/如何禁止 DrawerLayout 来将触摸事件传递给基础视图/" data-id="cin8zn6i7000gjtxu05x6igrp" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-Android/自定义ListView中的分割线" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/home/thrusday/workspace/makohill.github.io/public/2016/04/20/Android/自定义ListView中的分割线/" class="article-date">
  <time datetime="2016-04-20T14:59:39.297Z" itemprop="datePublished">2016-04-20</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>Title:  自定义ListView中的分割线<br>Date: 2014-03-06 22:46:39<br>Tag:Android</p>
<p>tags： Android ListView layout</p>
<ul>
<li>设置android:footerDividersEnabled，是否显示分割线，默认为true</li>
<li>设置android:divider和android:dividerHeight属性，改变ListView的分割线颜色和宽度</li>
</ul>
<p>####xml实例<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;ListView  </span><br><span class="line">    android:id=&quot;@+id/ListView1&quot;  </span><br><span class="line">    android:layout_width=&quot;match_parent&quot;  </span><br><span class="line">    android:layout_height=&quot;wrap_content&quot;  </span><br><span class="line">    android:divider=&quot;#CCCCCCS&quot;  </span><br><span class="line">    android:dividerHeight=&quot;1px&quot; /&gt;</span><br></pre></td></tr></table></figure></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://makohill.github.io/home/thrusday/workspace/makohill.github.io/public/2016/04/20/Android/自定义ListView中的分割线/" data-id="cin8zn6i8000hjtxuasa8rncq" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-Android/获取当前设备的系统版本号" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/home/thrusday/workspace/makohill.github.io/public/2016/04/20/Android/获取当前设备的系统版本号/" class="article-date">
  <time datetime="2016-04-20T14:59:39.297Z" itemprop="datePublished">2016-04-20</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>Title: 获取当前设备的系统版本号<br>Date: 2014-03-07 23:07:00<br>Tag:Android</p>
<p>####获取当前设备的系统版本号:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">int version = Build.VERSION.SDK_INT;</span><br></pre></td></tr></table></figure></p>
<p>####版本对应:</p>
<ul>
<li>API等级1：Android 1.0</li>
<li>API等级2：Android 1.1 Petit Four</li>
<li>API等级3：Android 1.5 Cupcake</li>
<li>API等级4：Android 1.6 Donut（甜甜圈）</li>
<li>API等级5：Android 2.0 Éclair（松饼）</li>
<li>API等级6：Android 2.0.1 Éclair</li>
<li>API等级7：Android 2.1 Éclair</li>
<li>API等级8：Android 2.2 - 2.2.3 Froyo（冻酸奶）</li>
<li>API等级9：Android 2.3 - 2.3.2 Gingerbread（姜饼）</li>
<li>API等级10：Android 2.3.3-2.3.7 Gingerbread</li>
<li>API等级11：Android 3.0 Honeycomb（蜂巢）</li>
<li>API等级12：Android 3.1 Honeycomb</li>
<li>API等级13：Android 3.2 Honeycomb</li>
<li>API等级14：Android 4.0 - 4.0.2 Ice Cream Sandwich（冰淇淋三明治）</li>
<li>API等级15：Android 4.0.3 - 4.0.4 Ice Cream Sandwich</li>
<li>API等级16：Android 4.1 Jelly Bean（果冻豆）</li>
<li>API等级17：Android 4.2 Jelly Bean</li>
<li>API等级18：Android 4.3 Jelly Bean</li>
<li>API等级19：Android 4.4 KitKat（奇巧巧克力棒）</li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://makohill.github.io/home/thrusday/workspace/makohill.github.io/public/2016/04/20/Android/获取当前设备的系统版本号/" data-id="cin8zn6if000ijtxu7w5pcozt" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-Android/开源项目：Android-PullToRefresh源码分析" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/home/thrusday/workspace/makohill.github.io/public/2016/04/20/Android/开源项目：Android-PullToRefresh源码分析/" class="article-date">
  <time datetime="2016-04-20T14:59:39.297Z" itemprop="datePublished">2016-04-20</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>Date: 2014-07-30 16:19:27<br>Title:开源项目：Android-PullToRefresh源码分析<br>Tag:Android</p>
<p>####功能实现</p>
<ol>
<li><p>项目github地址：<a href="https://github.com/chrisbanes/Android-PullToRefresh" target="_blank" rel="external">https://github.com/chrisbanes/Android-PullToRefresh</a></p>
</li>
<li><p>项目的目录结构</p>
</li>
</ol>
<p><img src="/_image/2014-06-02/9d40ce7a-049b-41e4-bab8-219c9b444b13.png" alt="Image Title"></p>
<ol>
<li>代码分析</li>
</ol>
<p>整个项目采用策略模式，把公共的部分实现为抽象类，并提供抽象接口(策略)让具体类来实现：<br>（1） PullToRefreshBase抽象类，实现的功能：scrollview、下拉/上拉逻辑，并把需要PullToRefresh的View(如：ListView、ScrollView等)提供接口给独立出来，让实现者提供，并把在哪里需要上拉和下拉也提供出接口、提供支持上下滚动或左右滚动的接口。<br>（2） LoadingLayout抽象类，实现的功能：基本Loading界面框架，但是把界面的元素(子View)独立出来，提供成接口，让实现者提供。<br>overscroll(弹簧阻尼效果)是通过ViewGroup的onInterceptTouchEvent()和onTouchEvent()函数通过过滤手势、捕捉手势，并且使用View的scrollTo()函数来实现的，当手势向下滑动或向上滑动的时候，使用scrollTo()函数做overscroll运动，当松开手势的时候，利用一个独立线程来scrollTo()滚动动画(采用View的post(Runnable)函数实现)到header，当refresh完成后，scrollTo()到0(不显示header/footer)；上拉/下拉刷新的footer/header是通过ViewGroup的addView根据是否是下拉/上拉或双向来加入的，header或footer是在PullToRefreshBase初始化的时候一开始就被addView()到要PollToRefresh的View（ListView或GradView）之前和之后的，也就是说header/footer刚开始时是塞在了ListView或GridView之前的顶部栏/之后的底部栏后隐藏的，所以下拉/上拉刷新的时候直接把隐藏的header/footer从顶部栏/底部栏之后拉出来了。<br>这3个子目录分别是com.handmark.pulltorefresh.library是客户端开发人员直接使用的类，./extras也是客户端开发人员直接使用的类，是对library的补充，./interal是library和./extras内部使用的自定义View类。其中，在library包中，PullToRefreshBase是基类(抽象类)，PullToRefreshListView等是客户端类，ILoadingLayout接口是针对Loading界面的回调接口，策略模式用于设置Loading界面的图像和文字，是被LoadingLayout继承实现的；IPullToRefresh是刷新动作回调接口，只在PullToRefreshBase中实现，IPullToRefresh类写成接口的目的应该是为了更加通用，目的是即使再重写一个PullToRefreshBase类都是可以的，并且PullToRefreshBase抽象类中提供了几个抽象方法：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"> // 子类实现scroll方向</span><br><span class="line">public abstract Orientation getPullToRefreshScrollDirection();</span><br><span class="line">// 子类实现可刷新View，例如ListView、GridView等</span><br><span class="line">protected abstract T createRefreshableView(Context context, AttributeSet attrs); </span><br><span class="line"> // 子类实现上拉刷新的条件，例如ListView实现上拉刷新的条件是上拉到底部</span><br><span class="line">protected abstract boolean isReadyForPullEnd();</span><br><span class="line"> // 子类实现下拉刷新的条件，例如ListView实现下拉刷新的条件是下拉到最上面第一行处</span><br><span class="line">protected abstract boolean isReadyForPullStart();</span><br></pre></td></tr></table></figure>
<p>(其实，对于继承AbsListView的ListView和GridView来说，该项目又封装了一层PullToRefreshAdapterViewBase)。<br>LoadingLayout是Loading界面的基类，也是抽象类，该抽象类根据x拉刷新方向，加载生成了一个基本Loading界面，可以让FlipLoadingLayout和RotateLoadingLayout继承，这2个类主要是指定了Loading界面中的图片动画，并实现以下抽象方法，指定各个状态时的图片：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">// If we don&apos;t have a user defined drawable, load the default</span><br><span class="line">protected abstract int getDefaultDrawableResId(); </span><br><span class="line"> // 设置Loading图片时候的回调</span><br><span class="line">protected abstract void onLoadingDrawableSet(Drawable imageDrawable);</span><br><span class="line">// 在手势下/上拉时候回调</span><br><span class="line">protected abstract void onPullImpl(float scaleOfLayout); </span><br><span class="line">// 下/上拉手势正在执行时的：刷新后的回调</span><br><span class="line">protected abstract void pullToRefreshImpl(); </span><br><span class="line"> // 正在下/上拉刷新中...的回调</span><br><span class="line">protected abstract void refreshingImpl();</span><br><span class="line"> // 手势释放后的回调</span><br><span class="line">protected abstract void releaseToRefreshImpl();</span><br><span class="line"> // Loading View重置后的回调</span><br><span class="line">protected abstract void resetImpl();</span><br></pre></td></tr></table></figure>
<p>####核心类PullToRefreshBase，代码分析如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br><span class="line">527</span><br><span class="line">528</span><br><span class="line">529</span><br><span class="line">530</span><br><span class="line">531</span><br><span class="line">532</span><br><span class="line">533</span><br><span class="line">534</span><br><span class="line">535</span><br><span class="line">536</span><br><span class="line">537</span><br><span class="line">538</span><br><span class="line">539</span><br><span class="line">540</span><br><span class="line">541</span><br><span class="line">542</span><br><span class="line">543</span><br><span class="line">544</span><br><span class="line">545</span><br><span class="line">546</span><br><span class="line">547</span><br><span class="line">548</span><br><span class="line">549</span><br><span class="line">550</span><br><span class="line">551</span><br><span class="line">552</span><br><span class="line">553</span><br><span class="line">554</span><br><span class="line">555</span><br><span class="line">556</span><br><span class="line">557</span><br><span class="line">558</span><br><span class="line">559</span><br><span class="line">560</span><br><span class="line">561</span><br><span class="line">562</span><br><span class="line">563</span><br><span class="line">564</span><br><span class="line">565</span><br><span class="line">566</span><br><span class="line">567</span><br><span class="line">568</span><br><span class="line">569</span><br><span class="line">570</span><br><span class="line">571</span><br><span class="line">572</span><br><span class="line">573</span><br><span class="line">574</span><br><span class="line">575</span><br><span class="line">576</span><br><span class="line">577</span><br><span class="line">578</span><br><span class="line">579</span><br><span class="line">580</span><br><span class="line">581</span><br><span class="line">582</span><br><span class="line">583</span><br><span class="line">584</span><br><span class="line">585</span><br><span class="line">586</span><br><span class="line">587</span><br><span class="line">588</span><br><span class="line">589</span><br><span class="line">590</span><br><span class="line">591</span><br><span class="line">592</span><br><span class="line">593</span><br><span class="line">594</span><br><span class="line">595</span><br><span class="line">596</span><br><span class="line">597</span><br><span class="line">598</span><br><span class="line">599</span><br><span class="line">600</span><br><span class="line">601</span><br><span class="line">602</span><br><span class="line">603</span><br><span class="line">604</span><br><span class="line">605</span><br><span class="line">606</span><br><span class="line">607</span><br><span class="line">608</span><br><span class="line">609</span><br><span class="line">610</span><br><span class="line">611</span><br><span class="line">612</span><br><span class="line">613</span><br><span class="line">614</span><br><span class="line">615</span><br><span class="line">616</span><br><span class="line">617</span><br><span class="line">618</span><br><span class="line">619</span><br><span class="line">620</span><br><span class="line">621</span><br><span class="line">622</span><br><span class="line">623</span><br><span class="line">624</span><br><span class="line">625</span><br><span class="line">626</span><br><span class="line">627</span><br><span class="line">628</span><br><span class="line">629</span><br><span class="line">630</span><br><span class="line">631</span><br><span class="line">632</span><br><span class="line">633</span><br><span class="line">634</span><br><span class="line">635</span><br><span class="line">636</span><br><span class="line">637</span><br><span class="line">638</span><br><span class="line">639</span><br><span class="line">640</span><br><span class="line">641</span><br><span class="line">642</span><br><span class="line">643</span><br><span class="line">644</span><br><span class="line">645</span><br><span class="line">646</span><br><span class="line">647</span><br><span class="line">648</span><br><span class="line">649</span><br><span class="line">650</span><br><span class="line">651</span><br><span class="line">652</span><br><span class="line">653</span><br><span class="line">654</span><br><span class="line">655</span><br><span class="line">656</span><br><span class="line">657</span><br><span class="line">658</span><br><span class="line">659</span><br><span class="line">660</span><br><span class="line">661</span><br><span class="line">662</span><br><span class="line">663</span><br><span class="line">664</span><br><span class="line">665</span><br><span class="line">666</span><br><span class="line">667</span><br><span class="line">668</span><br><span class="line">669</span><br><span class="line">670</span><br><span class="line">671</span><br><span class="line">672</span><br><span class="line">673</span><br><span class="line">674</span><br><span class="line">675</span><br><span class="line">676</span><br><span class="line">677</span><br><span class="line">678</span><br><span class="line">679</span><br><span class="line">680</span><br><span class="line">681</span><br><span class="line">682</span><br><span class="line">683</span><br><span class="line">684</span><br><span class="line">685</span><br><span class="line">686</span><br><span class="line">687</span><br><span class="line">688</span><br><span class="line">689</span><br><span class="line">690</span><br><span class="line">691</span><br><span class="line">692</span><br><span class="line">693</span><br><span class="line">694</span><br><span class="line">695</span><br><span class="line">696</span><br><span class="line">697</span><br><span class="line">698</span><br><span class="line">699</span><br><span class="line">700</span><br><span class="line">701</span><br><span class="line">702</span><br><span class="line">703</span><br><span class="line">704</span><br><span class="line">705</span><br><span class="line">706</span><br><span class="line">707</span><br><span class="line">708</span><br><span class="line">709</span><br><span class="line">710</span><br><span class="line">711</span><br><span class="line">712</span><br><span class="line">713</span><br><span class="line">714</span><br><span class="line">715</span><br><span class="line">716</span><br><span class="line">717</span><br><span class="line">718</span><br><span class="line">719</span><br><span class="line">720</span><br><span class="line">721</span><br><span class="line">722</span><br><span class="line">723</span><br><span class="line">724</span><br><span class="line">725</span><br><span class="line">726</span><br><span class="line">727</span><br><span class="line">728</span><br><span class="line">729</span><br><span class="line">730</span><br><span class="line">731</span><br><span class="line">732</span><br><span class="line">733</span><br><span class="line">734</span><br><span class="line">735</span><br><span class="line">736</span><br><span class="line">737</span><br><span class="line">738</span><br><span class="line">739</span><br><span class="line">740</span><br><span class="line">741</span><br><span class="line">742</span><br><span class="line">743</span><br><span class="line">744</span><br><span class="line">745</span><br><span class="line">746</span><br><span class="line">747</span><br><span class="line">748</span><br><span class="line">749</span><br><span class="line">750</span><br><span class="line">751</span><br><span class="line">752</span><br><span class="line">753</span><br><span class="line">754</span><br><span class="line">755</span><br><span class="line">756</span><br><span class="line">757</span><br><span class="line">758</span><br><span class="line">759</span><br><span class="line">760</span><br><span class="line">761</span><br><span class="line">762</span><br><span class="line">763</span><br><span class="line">764</span><br><span class="line">765</span><br><span class="line">766</span><br><span class="line">767</span><br><span class="line">768</span><br><span class="line">769</span><br><span class="line">770</span><br><span class="line">771</span><br><span class="line">772</span><br><span class="line">773</span><br><span class="line">774</span><br><span class="line">775</span><br><span class="line">776</span><br><span class="line">777</span><br><span class="line">778</span><br><span class="line">779</span><br><span class="line">780</span><br><span class="line">781</span><br><span class="line">782</span><br><span class="line">783</span><br><span class="line">784</span><br><span class="line">785</span><br><span class="line">786</span><br><span class="line">787</span><br><span class="line">788</span><br><span class="line">789</span><br><span class="line">790</span><br><span class="line">791</span><br><span class="line">792</span><br><span class="line">793</span><br><span class="line">794</span><br><span class="line">795</span><br><span class="line">796</span><br><span class="line">797</span><br><span class="line">798</span><br><span class="line">799</span><br><span class="line">800</span><br><span class="line">801</span><br><span class="line">802</span><br><span class="line">803</span><br><span class="line">804</span><br><span class="line">805</span><br><span class="line">806</span><br><span class="line">807</span><br><span class="line">808</span><br><span class="line">809</span><br><span class="line">810</span><br><span class="line">811</span><br><span class="line">812</span><br><span class="line">813</span><br><span class="line">814</span><br><span class="line">815</span><br><span class="line">816</span><br><span class="line">817</span><br><span class="line">818</span><br><span class="line">819</span><br><span class="line">820</span><br><span class="line">821</span><br><span class="line">822</span><br><span class="line">823</span><br><span class="line">824</span><br><span class="line">825</span><br><span class="line">826</span><br><span class="line">827</span><br><span class="line">828</span><br><span class="line">829</span><br><span class="line">830</span><br><span class="line">831</span><br><span class="line">832</span><br><span class="line">833</span><br><span class="line">834</span><br><span class="line">835</span><br><span class="line">836</span><br><span class="line">837</span><br><span class="line">838</span><br><span class="line">839</span><br><span class="line">840</span><br><span class="line">841</span><br><span class="line">842</span><br><span class="line">843</span><br><span class="line">844</span><br><span class="line">845</span><br><span class="line">846</span><br><span class="line">847</span><br><span class="line">848</span><br><span class="line">849</span><br><span class="line">850</span><br><span class="line">851</span><br><span class="line">852</span><br><span class="line">853</span><br><span class="line">854</span><br><span class="line">855</span><br><span class="line">856</span><br><span class="line">857</span><br><span class="line">858</span><br><span class="line">859</span><br><span class="line">860</span><br><span class="line">861</span><br><span class="line">862</span><br><span class="line">863</span><br><span class="line">864</span><br><span class="line">865</span><br><span class="line">866</span><br><span class="line">867</span><br><span class="line">868</span><br><span class="line">869</span><br><span class="line">870</span><br><span class="line">871</span><br><span class="line">872</span><br><span class="line">873</span><br><span class="line">874</span><br><span class="line">875</span><br><span class="line">876</span><br><span class="line">877</span><br><span class="line">878</span><br><span class="line">879</span><br><span class="line">880</span><br><span class="line">881</span><br><span class="line">882</span><br><span class="line">883</span><br><span class="line">884</span><br><span class="line">885</span><br><span class="line">886</span><br><span class="line">887</span><br><span class="line">888</span><br><span class="line">889</span><br><span class="line">890</span><br><span class="line">891</span><br><span class="line">892</span><br><span class="line">893</span><br><span class="line">894</span><br><span class="line">895</span><br><span class="line">896</span><br><span class="line">897</span><br><span class="line">898</span><br><span class="line">899</span><br><span class="line">900</span><br><span class="line">901</span><br><span class="line">902</span><br><span class="line">903</span><br><span class="line">904</span><br><span class="line">905</span><br><span class="line">906</span><br><span class="line">907</span><br><span class="line">908</span><br><span class="line">909</span><br><span class="line">910</span><br><span class="line">911</span><br><span class="line">912</span><br><span class="line">913</span><br><span class="line">914</span><br><span class="line">915</span><br><span class="line">916</span><br><span class="line">917</span><br><span class="line">918</span><br><span class="line">919</span><br><span class="line">920</span><br><span class="line">921</span><br><span class="line">922</span><br><span class="line">923</span><br><span class="line">924</span><br><span class="line">925</span><br><span class="line">926</span><br><span class="line">927</span><br><span class="line">928</span><br><span class="line">929</span><br><span class="line">930</span><br><span class="line">931</span><br><span class="line">932</span><br><span class="line">933</span><br><span class="line">934</span><br><span class="line">935</span><br><span class="line">936</span><br><span class="line">937</span><br><span class="line">938</span><br><span class="line">939</span><br><span class="line">940</span><br><span class="line">941</span><br><span class="line">942</span><br><span class="line">943</span><br><span class="line">944</span><br><span class="line">945</span><br><span class="line">946</span><br><span class="line">947</span><br><span class="line">948</span><br><span class="line">949</span><br><span class="line">950</span><br><span class="line">951</span><br><span class="line">952</span><br><span class="line">953</span><br><span class="line">954</span><br><span class="line">955</span><br><span class="line">956</span><br><span class="line">957</span><br><span class="line">958</span><br><span class="line">959</span><br><span class="line">960</span><br><span class="line">961</span><br><span class="line">962</span><br><span class="line">963</span><br><span class="line">964</span><br><span class="line">965</span><br><span class="line">966</span><br><span class="line">967</span><br><span class="line">968</span><br><span class="line">969</span><br><span class="line">970</span><br><span class="line">971</span><br><span class="line">972</span><br><span class="line">973</span><br><span class="line">974</span><br><span class="line">975</span><br><span class="line">976</span><br><span class="line">977</span><br><span class="line">978</span><br><span class="line">979</span><br><span class="line">980</span><br><span class="line">981</span><br><span class="line">982</span><br><span class="line">983</span><br><span class="line">984</span><br><span class="line">985</span><br><span class="line">986</span><br><span class="line">987</span><br><span class="line">988</span><br><span class="line">989</span><br><span class="line">990</span><br><span class="line">991</span><br><span class="line">992</span><br><span class="line">993</span><br><span class="line">994</span><br><span class="line">995</span><br><span class="line">996</span><br><span class="line">997</span><br><span class="line">998</span><br><span class="line">999</span><br><span class="line">1000</span><br><span class="line">1001</span><br><span class="line">1002</span><br><span class="line">1003</span><br><span class="line">1004</span><br><span class="line">1005</span><br><span class="line">1006</span><br><span class="line">1007</span><br><span class="line">1008</span><br><span class="line">1009</span><br><span class="line">1010</span><br><span class="line">1011</span><br><span class="line">1012</span><br><span class="line">1013</span><br><span class="line">1014</span><br><span class="line">1015</span><br><span class="line">1016</span><br><span class="line">1017</span><br><span class="line">1018</span><br><span class="line">1019</span><br><span class="line">1020</span><br><span class="line">1021</span><br><span class="line">1022</span><br><span class="line">1023</span><br><span class="line">1024</span><br><span class="line">1025</span><br><span class="line">1026</span><br><span class="line">1027</span><br><span class="line">1028</span><br><span class="line">1029</span><br><span class="line">1030</span><br><span class="line">1031</span><br><span class="line">1032</span><br><span class="line">1033</span><br><span class="line">1034</span><br><span class="line">1035</span><br><span class="line">1036</span><br><span class="line">1037</span><br><span class="line">1038</span><br><span class="line">1039</span><br><span class="line">1040</span><br><span class="line">1041</span><br><span class="line">1042</span><br><span class="line">1043</span><br><span class="line">1044</span><br><span class="line">1045</span><br><span class="line">1046</span><br><span class="line">1047</span><br><span class="line">1048</span><br><span class="line">1049</span><br><span class="line">1050</span><br><span class="line">1051</span><br><span class="line">1052</span><br><span class="line">1053</span><br><span class="line">1054</span><br><span class="line">1055</span><br><span class="line">1056</span><br><span class="line">1057</span><br><span class="line">1058</span><br><span class="line">1059</span><br><span class="line">1060</span><br><span class="line">1061</span><br><span class="line">1062</span><br><span class="line">1063</span><br><span class="line">1064</span><br><span class="line">1065</span><br><span class="line">1066</span><br><span class="line">1067</span><br><span class="line">1068</span><br><span class="line">1069</span><br><span class="line">1070</span><br><span class="line">1071</span><br><span class="line">1072</span><br><span class="line">1073</span><br><span class="line">1074</span><br><span class="line">1075</span><br><span class="line">1076</span><br><span class="line">1077</span><br><span class="line">1078</span><br><span class="line">1079</span><br><span class="line">1080</span><br><span class="line">1081</span><br><span class="line">1082</span><br><span class="line">1083</span><br><span class="line">1084</span><br><span class="line">1085</span><br><span class="line">1086</span><br><span class="line">1087</span><br><span class="line">1088</span><br><span class="line">1089</span><br><span class="line">1090</span><br><span class="line">1091</span><br><span class="line">1092</span><br><span class="line">1093</span><br><span class="line">1094</span><br><span class="line">1095</span><br><span class="line">1096</span><br><span class="line">1097</span><br><span class="line">1098</span><br><span class="line">1099</span><br><span class="line">1100</span><br><span class="line">1101</span><br><span class="line">1102</span><br><span class="line">1103</span><br><span class="line">1104</span><br><span class="line">1105</span><br><span class="line">1106</span><br><span class="line">1107</span><br><span class="line">1108</span><br><span class="line">1109</span><br><span class="line">1110</span><br><span class="line">1111</span><br><span class="line">1112</span><br><span class="line">1113</span><br><span class="line">1114</span><br><span class="line">1115</span><br><span class="line">1116</span><br><span class="line">1117</span><br><span class="line">1118</span><br><span class="line">1119</span><br><span class="line">1120</span><br><span class="line">1121</span><br><span class="line">1122</span><br><span class="line">1123</span><br><span class="line">1124</span><br><span class="line">1125</span><br><span class="line">1126</span><br><span class="line">1127</span><br><span class="line">1128</span><br><span class="line">1129</span><br><span class="line">1130</span><br><span class="line">1131</span><br><span class="line">1132</span><br><span class="line">1133</span><br><span class="line">1134</span><br><span class="line">1135</span><br><span class="line">1136</span><br><span class="line">1137</span><br><span class="line">1138</span><br><span class="line">1139</span><br><span class="line">1140</span><br><span class="line">1141</span><br><span class="line">1142</span><br><span class="line">1143</span><br><span class="line">1144</span><br><span class="line">1145</span><br><span class="line">1146</span><br><span class="line">1147</span><br><span class="line">1148</span><br><span class="line">1149</span><br><span class="line">1150</span><br><span class="line">1151</span><br><span class="line">1152</span><br><span class="line">1153</span><br><span class="line">1154</span><br><span class="line">1155</span><br><span class="line">1156</span><br><span class="line">1157</span><br><span class="line">1158</span><br><span class="line">1159</span><br><span class="line">1160</span><br><span class="line">1161</span><br><span class="line">1162</span><br><span class="line">1163</span><br><span class="line">1164</span><br><span class="line">1165</span><br><span class="line">1166</span><br><span class="line">1167</span><br><span class="line">1168</span><br><span class="line">1169</span><br><span class="line">1170</span><br><span class="line">1171</span><br><span class="line">1172</span><br><span class="line">1173</span><br><span class="line">1174</span><br><span class="line">1175</span><br><span class="line">1176</span><br><span class="line">1177</span><br><span class="line">1178</span><br><span class="line">1179</span><br><span class="line">1180</span><br><span class="line">1181</span><br><span class="line">1182</span><br><span class="line">1183</span><br><span class="line">1184</span><br><span class="line">1185</span><br><span class="line">1186</span><br><span class="line">1187</span><br><span class="line">1188</span><br><span class="line">1189</span><br><span class="line">1190</span><br><span class="line">1191</span><br><span class="line">1192</span><br><span class="line">1193</span><br><span class="line">1194</span><br><span class="line">1195</span><br><span class="line">1196</span><br><span class="line">1197</span><br><span class="line">1198</span><br><span class="line">1199</span><br><span class="line">1200</span><br><span class="line">1201</span><br><span class="line">1202</span><br><span class="line">1203</span><br><span class="line">1204</span><br><span class="line">1205</span><br><span class="line">1206</span><br><span class="line">1207</span><br><span class="line">1208</span><br><span class="line">1209</span><br><span class="line">1210</span><br><span class="line">1211</span><br><span class="line">1212</span><br><span class="line">1213</span><br><span class="line">1214</span><br><span class="line">1215</span><br><span class="line">1216</span><br><span class="line">1217</span><br><span class="line">1218</span><br><span class="line">1219</span><br><span class="line">1220</span><br><span class="line">1221</span><br><span class="line">1222</span><br><span class="line">1223</span><br><span class="line">1224</span><br><span class="line">1225</span><br><span class="line">1226</span><br><span class="line">1227</span><br><span class="line">1228</span><br><span class="line">1229</span><br><span class="line">1230</span><br><span class="line">1231</span><br><span class="line">1232</span><br><span class="line">1233</span><br><span class="line">1234</span><br><span class="line">1235</span><br><span class="line">1236</span><br><span class="line">1237</span><br><span class="line">1238</span><br><span class="line">1239</span><br><span class="line">1240</span><br><span class="line">1241</span><br><span class="line">1242</span><br><span class="line">1243</span><br><span class="line">1244</span><br><span class="line">1245</span><br><span class="line">1246</span><br><span class="line">1247</span><br><span class="line">1248</span><br><span class="line">1249</span><br><span class="line">1250</span><br><span class="line">1251</span><br><span class="line">1252</span><br><span class="line">1253</span><br><span class="line">1254</span><br><span class="line">1255</span><br><span class="line">1256</span><br><span class="line">1257</span><br><span class="line">1258</span><br><span class="line">1259</span><br><span class="line">1260</span><br><span class="line">1261</span><br><span class="line">1262</span><br><span class="line">1263</span><br><span class="line">1264</span><br><span class="line">1265</span><br><span class="line">1266</span><br><span class="line">1267</span><br><span class="line">1268</span><br><span class="line">1269</span><br><span class="line">1270</span><br><span class="line">1271</span><br><span class="line">1272</span><br><span class="line">1273</span><br><span class="line">1274</span><br><span class="line">1275</span><br><span class="line">1276</span><br><span class="line">1277</span><br><span class="line">1278</span><br><span class="line">1279</span><br><span class="line">1280</span><br><span class="line">1281</span><br><span class="line">1282</span><br><span class="line">1283</span><br><span class="line">1284</span><br><span class="line">1285</span><br><span class="line">1286</span><br><span class="line">1287</span><br><span class="line">1288</span><br><span class="line">1289</span><br><span class="line">1290</span><br><span class="line">1291</span><br><span class="line">1292</span><br><span class="line">1293</span><br><span class="line">1294</span><br><span class="line">1295</span><br><span class="line">1296</span><br><span class="line">1297</span><br><span class="line">1298</span><br><span class="line">1299</span><br><span class="line">1300</span><br><span class="line">1301</span><br><span class="line">1302</span><br><span class="line">1303</span><br><span class="line">1304</span><br><span class="line">1305</span><br><span class="line">1306</span><br><span class="line">1307</span><br><span class="line">1308</span><br><span class="line">1309</span><br><span class="line">1310</span><br><span class="line">1311</span><br><span class="line">1312</span><br><span class="line">1313</span><br><span class="line">1314</span><br><span class="line">1315</span><br><span class="line">1316</span><br><span class="line">1317</span><br><span class="line">1318</span><br><span class="line">1319</span><br><span class="line">1320</span><br><span class="line">1321</span><br><span class="line">1322</span><br><span class="line">1323</span><br><span class="line">1324</span><br><span class="line">1325</span><br><span class="line">1326</span><br><span class="line">1327</span><br><span class="line">1328</span><br><span class="line">1329</span><br><span class="line">1330</span><br><span class="line">1331</span><br><span class="line">1332</span><br><span class="line">1333</span><br><span class="line">1334</span><br><span class="line">1335</span><br><span class="line">1336</span><br><span class="line">1337</span><br><span class="line">1338</span><br><span class="line">1339</span><br><span class="line">1340</span><br><span class="line">1341</span><br><span class="line">1342</span><br><span class="line">1343</span><br><span class="line">1344</span><br><span class="line">1345</span><br><span class="line">1346</span><br><span class="line">1347</span><br><span class="line">1348</span><br><span class="line">1349</span><br><span class="line">1350</span><br><span class="line">1351</span><br><span class="line">1352</span><br><span class="line">1353</span><br><span class="line">1354</span><br><span class="line">1355</span><br><span class="line">1356</span><br><span class="line">1357</span><br><span class="line">1358</span><br><span class="line">1359</span><br><span class="line">1360</span><br><span class="line">1361</span><br><span class="line">1362</span><br><span class="line">1363</span><br><span class="line">1364</span><br><span class="line">1365</span><br><span class="line">1366</span><br><span class="line">1367</span><br><span class="line">1368</span><br><span class="line">1369</span><br><span class="line">1370</span><br><span class="line">1371</span><br><span class="line">1372</span><br><span class="line">1373</span><br><span class="line">1374</span><br><span class="line">1375</span><br><span class="line">1376</span><br><span class="line">1377</span><br><span class="line">1378</span><br><span class="line">1379</span><br><span class="line">1380</span><br><span class="line">1381</span><br><span class="line">1382</span><br><span class="line">1383</span><br><span class="line">1384</span><br><span class="line">1385</span><br><span class="line">1386</span><br><span class="line">1387</span><br><span class="line">1388</span><br><span class="line">1389</span><br><span class="line">1390</span><br><span class="line">1391</span><br><span class="line">1392</span><br><span class="line">1393</span><br><span class="line">1394</span><br><span class="line">1395</span><br><span class="line">1396</span><br><span class="line">1397</span><br><span class="line">1398</span><br><span class="line">1399</span><br><span class="line">1400</span><br><span class="line">1401</span><br><span class="line">1402</span><br><span class="line">1403</span><br><span class="line">1404</span><br><span class="line">1405</span><br><span class="line">1406</span><br><span class="line">1407</span><br><span class="line">1408</span><br><span class="line">1409</span><br><span class="line">1410</span><br><span class="line">1411</span><br><span class="line">1412</span><br><span class="line">1413</span><br><span class="line">1414</span><br><span class="line">1415</span><br><span class="line">1416</span><br><span class="line">1417</span><br><span class="line">1418</span><br><span class="line">1419</span><br><span class="line">1420</span><br><span class="line">1421</span><br><span class="line">1422</span><br><span class="line">1423</span><br><span class="line">1424</span><br><span class="line">1425</span><br><span class="line">1426</span><br><span class="line">1427</span><br><span class="line">1428</span><br><span class="line">1429</span><br><span class="line">1430</span><br><span class="line">1431</span><br><span class="line">1432</span><br><span class="line">1433</span><br><span class="line">1434</span><br><span class="line">1435</span><br><span class="line">1436</span><br><span class="line">1437</span><br><span class="line">1438</span><br><span class="line">1439</span><br><span class="line">1440</span><br><span class="line">1441</span><br><span class="line">1442</span><br><span class="line">1443</span><br><span class="line">1444</span><br><span class="line">1445</span><br><span class="line">1446</span><br><span class="line">1447</span><br><span class="line">1448</span><br><span class="line">1449</span><br><span class="line">1450</span><br><span class="line">1451</span><br><span class="line">1452</span><br><span class="line">1453</span><br><span class="line">1454</span><br><span class="line">1455</span><br><span class="line">1456</span><br><span class="line">1457</span><br><span class="line">1458</span><br><span class="line">1459</span><br><span class="line">1460</span><br><span class="line">1461</span><br><span class="line">1462</span><br><span class="line">1463</span><br><span class="line">1464</span><br><span class="line">1465</span><br><span class="line">1466</span><br><span class="line">1467</span><br><span class="line">1468</span><br><span class="line">1469</span><br><span class="line">1470</span><br><span class="line">1471</span><br><span class="line">1472</span><br><span class="line">1473</span><br><span class="line">1474</span><br><span class="line">1475</span><br><span class="line">1476</span><br><span class="line">1477</span><br><span class="line">1478</span><br><span class="line">1479</span><br><span class="line">1480</span><br><span class="line">1481</span><br><span class="line">1482</span><br><span class="line">1483</span><br><span class="line">1484</span><br><span class="line">1485</span><br><span class="line">1486</span><br><span class="line">1487</span><br><span class="line">1488</span><br><span class="line">1489</span><br><span class="line">1490</span><br><span class="line">1491</span><br><span class="line">1492</span><br><span class="line">1493</span><br><span class="line">1494</span><br><span class="line">1495</span><br><span class="line">1496</span><br><span class="line">1497</span><br><span class="line">1498</span><br><span class="line">1499</span><br><span class="line">1500</span><br><span class="line">1501</span><br><span class="line">1502</span><br><span class="line">1503</span><br><span class="line">1504</span><br><span class="line">1505</span><br><span class="line">1506</span><br><span class="line">1507</span><br><span class="line">1508</span><br><span class="line">1509</span><br><span class="line">1510</span><br><span class="line">1511</span><br><span class="line">1512</span><br><span class="line">1513</span><br><span class="line">1514</span><br><span class="line">1515</span><br><span class="line">1516</span><br><span class="line">1517</span><br><span class="line">1518</span><br><span class="line">1519</span><br><span class="line">1520</span><br><span class="line">1521</span><br><span class="line">1522</span><br><span class="line">1523</span><br><span class="line">1524</span><br><span class="line">1525</span><br><span class="line">1526</span><br><span class="line">1527</span><br><span class="line">1528</span><br><span class="line">1529</span><br><span class="line">1530</span><br><span class="line">1531</span><br><span class="line">1532</span><br><span class="line">1533</span><br><span class="line">1534</span><br><span class="line">1535</span><br><span class="line">1536</span><br><span class="line">1537</span><br><span class="line">1538</span><br><span class="line">1539</span><br><span class="line">1540</span><br><span class="line">1541</span><br><span class="line">1542</span><br><span class="line">1543</span><br><span class="line">1544</span><br><span class="line">1545</span><br><span class="line">1546</span><br><span class="line">1547</span><br><span class="line">1548</span><br><span class="line">1549</span><br><span class="line">1550</span><br><span class="line">1551</span><br><span class="line">1552</span><br><span class="line">1553</span><br><span class="line">1554</span><br><span class="line">1555</span><br><span class="line">1556</span><br><span class="line">1557</span><br><span class="line">1558</span><br><span class="line">1559</span><br><span class="line">1560</span><br><span class="line">1561</span><br><span class="line">1562</span><br><span class="line">1563</span><br><span class="line">1564</span><br><span class="line">1565</span><br><span class="line">1566</span><br><span class="line">1567</span><br><span class="line">1568</span><br><span class="line">1569</span><br><span class="line">1570</span><br><span class="line">1571</span><br><span class="line">1572</span><br><span class="line">1573</span><br><span class="line">1574</span><br><span class="line">1575</span><br><span class="line">1576</span><br><span class="line">1577</span><br><span class="line">1578</span><br><span class="line">1579</span><br><span class="line">1580</span><br><span class="line">1581</span><br><span class="line">1582</span><br><span class="line">1583</span><br><span class="line">1584</span><br><span class="line">1585</span><br><span class="line">1586</span><br><span class="line">1587</span><br><span class="line">1588</span><br><span class="line">1589</span><br><span class="line">1590</span><br><span class="line">1591</span><br><span class="line">1592</span><br><span class="line">1593</span><br><span class="line">1594</span><br><span class="line">1595</span><br><span class="line">1596</span><br><span class="line">1597</span><br><span class="line">1598</span><br><span class="line">1599</span><br><span class="line">1600</span><br><span class="line">1601</span><br><span class="line">1602</span><br><span class="line">1603</span><br><span class="line">1604</span><br><span class="line">1605</span><br><span class="line">1606</span><br><span class="line">1607</span><br><span class="line">1608</span><br><span class="line">1609</span><br><span class="line">1610</span><br><span class="line">1611</span><br><span class="line">1612</span><br><span class="line">1613</span><br><span class="line">1614</span><br><span class="line">1615</span><br><span class="line">1616</span><br><span class="line">1617</span><br><span class="line">1618</span><br><span class="line">1619</span><br><span class="line">1620</span><br><span class="line">1621</span><br><span class="line">1622</span><br><span class="line">1623</span><br><span class="line">1624</span><br><span class="line">1625</span><br><span class="line">1626</span><br><span class="line">1627</span><br><span class="line">1628</span><br><span class="line">1629</span><br><span class="line">1630</span><br><span class="line">1631</span><br><span class="line">1632</span><br><span class="line">1633</span><br><span class="line">1634</span><br><span class="line">1635</span><br><span class="line">1636</span><br><span class="line">1637</span><br><span class="line">1638</span><br><span class="line">1639</span><br><span class="line">1640</span><br><span class="line">1641</span><br><span class="line">1642</span><br><span class="line">1643</span><br><span class="line">1644</span><br><span class="line">1645</span><br><span class="line">1646</span><br><span class="line">1647</span><br><span class="line">1648</span><br><span class="line">1649</span><br><span class="line">1650</span><br><span class="line">1651</span><br><span class="line">1652</span><br><span class="line">1653</span><br><span class="line">1654</span><br><span class="line">1655</span><br><span class="line">1656</span><br><span class="line">1657</span><br><span class="line">1658</span><br><span class="line">1659</span><br><span class="line">1660</span><br><span class="line">1661</span><br><span class="line">1662</span><br><span class="line">1663</span><br><span class="line">1664</span><br><span class="line">1665</span><br><span class="line">1666</span><br><span class="line">1667</span><br><span class="line">1668</span><br><span class="line">1669</span><br><span class="line">1670</span><br><span class="line">1671</span><br><span class="line">1672</span><br><span class="line">1673</span><br><span class="line">1674</span><br><span class="line">1675</span><br><span class="line">1676</span><br><span class="line">1677</span><br><span class="line">1678</span><br><span class="line">1679</span><br><span class="line">1680</span><br><span class="line">1681</span><br><span class="line">1682</span><br><span class="line">1683</span><br><span class="line">1684</span><br><span class="line">1685</span><br><span class="line">1686</span><br><span class="line">1687</span><br><span class="line">1688</span><br><span class="line">1689</span><br><span class="line">1690</span><br><span class="line">1691</span><br><span class="line">1692</span><br><span class="line">1693</span><br><span class="line">1694</span><br><span class="line">1695</span><br><span class="line">1696</span><br><span class="line">1697</span><br><span class="line">1698</span><br><span class="line">1699</span><br><span class="line">1700</span><br><span class="line">1701</span><br><span class="line">1702</span><br><span class="line">1703</span><br><span class="line">1704</span><br><span class="line">1705</span><br><span class="line">1706</span><br><span class="line">1707</span><br><span class="line">1708</span><br><span class="line">1709</span><br><span class="line">1710</span><br><span class="line">1711</span><br><span class="line">1712</span><br><span class="line">1713</span><br><span class="line">1714</span><br><span class="line">1715</span><br><span class="line">1716</span><br><span class="line">1717</span><br><span class="line">1718</span><br><span class="line">1719</span><br><span class="line">1720</span><br><span class="line">1721</span><br><span class="line">1722</span><br><span class="line">1723</span><br><span class="line">1724</span><br><span class="line">1725</span><br><span class="line">1726</span><br><span class="line">1727</span><br><span class="line">1728</span><br><span class="line">1729</span><br><span class="line">1730</span><br><span class="line">1731</span><br><span class="line">1732</span><br><span class="line">1733</span><br><span class="line">1734</span><br><span class="line">1735</span><br><span class="line">1736</span><br><span class="line">1737</span><br><span class="line">1738</span><br><span class="line">1739</span><br><span class="line">1740</span><br><span class="line">1741</span><br><span class="line">1742</span><br><span class="line">1743</span><br><span class="line">1744</span><br><span class="line">1745</span><br><span class="line">1746</span><br><span class="line">1747</span><br><span class="line">1748</span><br><span class="line">1749</span><br><span class="line">1750</span><br><span class="line">1751</span><br><span class="line">1752</span><br><span class="line">1753</span><br><span class="line">1754</span><br><span class="line">1755</span><br><span class="line">1756</span><br><span class="line">1757</span><br><span class="line">1758</span><br><span class="line">1759</span><br><span class="line">1760</span><br><span class="line">1761</span><br><span class="line">1762</span><br><span class="line">1763</span><br><span class="line">1764</span><br><span class="line">1765</span><br><span class="line">1766</span><br><span class="line">1767</span><br><span class="line">1768</span><br><span class="line">1769</span><br><span class="line">1770</span><br><span class="line">1771</span><br><span class="line">1772</span><br><span class="line">1773</span><br><span class="line">1774</span><br><span class="line">1775</span><br><span class="line">1776</span><br><span class="line">1777</span><br><span class="line">1778</span><br><span class="line">1779</span><br><span class="line">1780</span><br><span class="line">1781</span><br><span class="line">1782</span><br><span class="line">1783</span><br><span class="line">1784</span><br><span class="line">1785</span><br><span class="line">1786</span><br><span class="line">1787</span><br><span class="line">1788</span><br><span class="line">1789</span><br><span class="line">1790</span><br><span class="line">1791</span><br></pre></td><td class="code"><pre><span class="line">/**</span><br><span class="line"> * 这个类是基类，实现了下拉/上拉刷新，并且提供抽象方法给继承类实现：提供Refreshable View、</span><br><span class="line"> * 提供上拉/下拉刷新的时机、支持纵向或横向刷新。</span><br><span class="line"> * (1)此抽象类初始化的界面是：加入refreshable view(如：ListView、ScrollView等)，加入loading header</span><br><span class="line"> * 或footer到界面中，然后把header或footer高度或宽度设置为整个界面高度或宽度的一半，之后把整个header或</span><br><span class="line"> * footer塞到顶部栏或底部栏之后，使整个界面只看到了refreshable view，当下拉或上拉的时候才能看到header</span><br><span class="line"> * 或footer，这也是overscroll(弹簧阻尼效果)实现方案。</span><br><span class="line"> * (2)重写onInterceptTouchEvent()和onTouchEvent实现下拉/上拉刷新，当移动手势的时，使用scrollTo()</span><br><span class="line"> * 函数滚动界面，当放开手势的时候，开启一个独立线程执行scrollTo()函数来滚动界面回滚，然后等刷新完成的时候，</span><br><span class="line"> * 界面滚动到初始状态。【我们自定义的View及其子类的滚动动画基本上都是使用scrollTo()配合Animation及其子类来完成的】。</span><br><span class="line"> * </span><br><span class="line"> * 这个类可用于一切需要overscroll效果的view。</span><br><span class="line"> * </span><br><span class="line"> * @param &lt;T&gt; Refreshable View，比如：ListView ScrollView等</span><br><span class="line"> */</span><br><span class="line">public abstract class PullToRefreshBase&lt;T extends View&gt; extends LinearLayout </span><br><span class="line">		implements IPullToRefresh&lt;T&gt; &#123;</span><br><span class="line"></span><br><span class="line">	// ===========================================================</span><br><span class="line">	// Constants</span><br><span class="line">	// ===========================================================</span><br><span class="line">	static final String LOG_TAG = &quot;PullToRefresh&quot;;</span><br><span class="line">	static final boolean DEBUG = true;</span><br><span class="line">	static final boolean USE_HW_LAYERS = false;</span><br><span class="line">	static final float FRICTION = 2.0f;</span><br><span class="line"></span><br><span class="line">	public static final int SMOOTH_SCROLL_DURATION_MS = 200;</span><br><span class="line">	public static final int SMOOTH_SCROLL_LONG_DURATION_MS = 325;</span><br><span class="line">	static final int DEMO_SCROLL_INTERVAL = 225;</span><br><span class="line"></span><br><span class="line">	static final String STATE_STATE = &quot;ptr_state&quot;;</span><br><span class="line">	static final String STATE_MODE = &quot;ptr_mode&quot;;</span><br><span class="line">	static final String STATE_CURRENT_MODE = &quot;ptr_current_mode&quot;;</span><br><span class="line">	static final String STATE_SCROLLING_REFRESHING_ENABLED = &quot;ptr_disable_scrolling&quot;;</span><br><span class="line">	static final String STATE_SHOW_REFRESHING_VIEW = &quot;ptr_show_refreshing_view&quot;;</span><br><span class="line">	static final String STATE_SUPER = &quot;ptr_super&quot;;</span><br><span class="line"></span><br><span class="line">	// ===========================================================</span><br><span class="line">	// Fields</span><br><span class="line">	// ===========================================================</span><br><span class="line"></span><br><span class="line">	private int mTouchSlop; // TouchSlop</span><br><span class="line">	private float mLastMotionX, mLastMotionY; // 上一次手势坐标</span><br><span class="line">	private float mInitialMotionX, mInitialMotionY; // 初始手势坐标</span><br><span class="line"></span><br><span class="line">	private boolean mIsBeingDragged = false; // 标记正在手势拖动下拉刷新中...</span><br><span class="line">	private State mState = State.RESET; // 默认是重启状态</span><br><span class="line">	private Mode mMode = Mode.getDefault(); // 默认是下拉刷新</span><br><span class="line"></span><br><span class="line">	private Mode mCurrentMode; // 当前模式</span><br><span class="line">	T mRefreshableView; // 当前被刷新的View: ListView</span><br><span class="line">	private FrameLayout mRefreshableViewWrapper; // 可刷新View(例如ListView)的包装器</span><br><span class="line"></span><br><span class="line">	private boolean mShowViewWhileRefreshing = true; // 当刷新的时候是否允许展示View</span><br><span class="line">	private boolean mScrollingWhileRefreshingEnabled = false; // 当刷新的时候是否允许滚动</span><br><span class="line">	private boolean mFilterTouchEvents = true; // 是否过滤触摸事件</span><br><span class="line">	private boolean mOverScrollEnabled = true; // 是否允许过滚动(弹簧效果)</span><br><span class="line">	private boolean mLayoutVisibilityChangesEnabled = true;</span><br><span class="line"></span><br><span class="line">	private Interpolator mScrollAnimationInterpolator;</span><br><span class="line">	private AnimationStyle mLoadingAnimationStyle = AnimationStyle.getDefault();</span><br><span class="line"></span><br><span class="line">	private LoadingLayout mHeaderLayout; // Loading头部界面</span><br><span class="line">	private LoadingLayout mFooterLayout; // Loading尾部界面</span><br><span class="line"></span><br><span class="line">	private OnRefreshListener&lt;T&gt; mOnRefreshListener;</span><br><span class="line">	private OnRefreshListener2&lt;T&gt; mOnRefreshListener2;</span><br><span class="line">	private OnPullEventListener&lt;T&gt; mOnPullEventListener;</span><br><span class="line"></span><br><span class="line">	private SmoothScrollRunnable mCurrentSmoothScrollRunnable;	// x拉刷新滚动子线程</span><br><span class="line"></span><br><span class="line">	// ===========================================================</span><br><span class="line">	// Constructors</span><br><span class="line">	// ===========================================================</span><br><span class="line"></span><br><span class="line">	public PullToRefreshBase(Context context) &#123;</span><br><span class="line">		super(context);</span><br><span class="line">		init(context, null);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	public PullToRefreshBase(Context context, AttributeSet attrs) &#123;</span><br><span class="line">		super(context, attrs);</span><br><span class="line">		init(context, attrs);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	public PullToRefreshBase(Context context, Mode mode) &#123;</span><br><span class="line">		super(context);</span><br><span class="line">		mMode = mode;</span><br><span class="line">		init(context, null);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	public PullToRefreshBase(Context context, Mode mode, AnimationStyle animStyle) &#123;</span><br><span class="line">		super(context);</span><br><span class="line">		mMode = mode;</span><br><span class="line">		mLoadingAnimationStyle = animStyle;</span><br><span class="line">		init(context, null);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	/**</span><br><span class="line">	 * 这个重写函数非常重要：当该类用于ListView、ScrollView的时候，这些控件组一定会包含子控件，</span><br><span class="line">	 * 因此一定需要重写这个方法，让其孩子加入到真正的控件中。</span><br><span class="line">	 */</span><br><span class="line">	@Override</span><br><span class="line">	public void addView(View child, int index, ViewGroup.LayoutParams params) &#123;</span><br><span class="line">		if (DEBUG) &#123;</span><br><span class="line">			Log.d(LOG_TAG, &quot;addView: &quot; + child.getClass().getSimpleName());</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		final T refreshableView = getRefreshableView();</span><br><span class="line"></span><br><span class="line">		if (refreshableView instanceof ViewGroup) &#123;</span><br><span class="line">			((ViewGroup) refreshableView).addView(child, index, params);</span><br><span class="line">		&#125; else &#123;</span><br><span class="line">			throw new UnsupportedOperationException(&quot;Refreshable View is not a &quot; +</span><br><span class="line">					&quot;ViewGroup so can&apos;t addView&quot;);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	@Override</span><br><span class="line">	public final boolean demo() &#123;</span><br><span class="line">		if (mMode.showHeaderLoadingLayout() &amp;&amp; isReadyForPullStart()) &#123;</span><br><span class="line">			smoothScrollToAndBack(-getHeaderSize() * 2);</span><br><span class="line">			return true;</span><br><span class="line">		&#125; else if (mMode.showFooterLoadingLayout() &amp;&amp; isReadyForPullEnd()) &#123;</span><br><span class="line">			smoothScrollToAndBack(getFooterSize() * 2);</span><br><span class="line">			return true;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		return false;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	/**</span><br><span class="line">	 * 获得当前Pull模式</span><br><span class="line">	 */</span><br><span class="line">	@Override</span><br><span class="line">	public final Mode getCurrentMode() &#123;</span><br><span class="line">		return mCurrentMode;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	@Override</span><br><span class="line">	public final boolean getFilterTouchEvents() &#123;</span><br><span class="line">		return mFilterTouchEvents;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	/**</span><br><span class="line">	 * 获得下拉/上拉Loading布局代理，主要是关于下拉/上拉Loading header or footer</span><br><span class="line">	 * 相关的文字/View等</span><br><span class="line">	 */</span><br><span class="line">	@Override</span><br><span class="line">	public final ILoadingLayout getLoadingLayoutProxy() &#123;</span><br><span class="line">		return getLoadingLayoutProxy(true, true);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	@Override</span><br><span class="line">	public final ILoadingLayout getLoadingLayoutProxy(boolean includeStart, boolean includeEnd) &#123;</span><br><span class="line">		return createLoadingLayoutProxy(includeStart, includeEnd);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	@Override</span><br><span class="line">	public final Mode getMode() &#123;</span><br><span class="line">		return mMode;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	/**</span><br><span class="line">	 * 获得可刷新的View，比如ListView、GridView等</span><br><span class="line">	 */</span><br><span class="line">	@Override</span><br><span class="line">	public final T getRefreshableView() &#123;</span><br><span class="line">		return mRefreshableView;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	@Override</span><br><span class="line">	public final boolean getShowViewWhileRefreshing() &#123;</span><br><span class="line">		return mShowViewWhileRefreshing;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	@Override</span><br><span class="line">	public final State getState() &#123;</span><br><span class="line">		return mState;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	/**</span><br><span class="line">	 * @deprecated See &#123;@link #isScrollingWhileRefreshingEnabled()&#125;.</span><br><span class="line">	 */</span><br><span class="line">	public final boolean isDisableScrollingWhileRefreshing() &#123;</span><br><span class="line">		return !isScrollingWhileRefreshingEnabled();</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	/**</span><br><span class="line">	 * 判断是否Pull刷新使能</span><br><span class="line">	 */</span><br><span class="line">	@Override</span><br><span class="line">	public final boolean isPullToRefreshEnabled() &#123;</span><br><span class="line">		return mMode.permitsPullToRefresh();</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	/**</span><br><span class="line">	 * 是否允许过滚动效果(弹簧效果)</span><br><span class="line">	 */</span><br><span class="line">	@Override</span><br><span class="line">	public final boolean isPullToRefreshOverScrollEnabled() &#123;</span><br><span class="line">		return VERSION.SDK_INT &gt;= VERSION_CODES.GINGERBREAD &amp;&amp; mOverScrollEnabled</span><br><span class="line">				&amp;&amp; OverscrollHelper.isAndroidOverScrollEnabled(mRefreshableView);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	/**</span><br><span class="line">	 * 返回是否正在刷新</span><br><span class="line">	 */</span><br><span class="line">	@Override</span><br><span class="line">	public final boolean isRefreshing() &#123;</span><br><span class="line">		return mState == State.REFRESHING || mState == State.MANUAL_REFRESHING;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	@Override</span><br><span class="line">	public final boolean isScrollingWhileRefreshingEnabled() &#123;</span><br><span class="line">		return mScrollingWhileRefreshingEnabled;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	/**</span><br><span class="line">	 * 重写这个函数的目的就是，拦截上拉/下拉事件给此PullToRefresh的onTouchEvent()函数处理，</span><br><span class="line">	 * 其余事件仍旧传递给子View处理，不改变子View原本的手势处理方式。</span><br><span class="line">	 * </span><br><span class="line">	 * 重写该方法处理手势事件，实现下拉刷新。在这里过滤下手势事件，该PullToRefresh本身</span><br><span class="line">	 * 只处理满足条件的下拉/上拉刷新事件，其余事件仍旧需要传递给子View(如ListView等)处理。</span><br><span class="line">	 * </span><br><span class="line">	 * 当手势时拖动中，并且满足下拉刷新或上拉刷新条件的时候，返回true拦截向子View传递</span><br><span class="line">	 * 手势事件，让PullToRefresh自己在onTouchEvent()中处理上拉或下拉刷新事件。</span><br><span class="line">	 */</span><br><span class="line">	@Override</span><br><span class="line">	public final boolean onInterceptTouchEvent(MotionEvent event) &#123;</span><br><span class="line">		if (!isPullToRefreshEnabled()) &#123; // 如果不支持上拉/下拉刷新功能</span><br><span class="line">			return false; // 不处理手势事件，向下传递</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">		final int action = event.getAction();</span><br><span class="line">		if (action == MotionEvent.ACTION_CANCEL || action == MotionEvent.ACTION_UP) &#123;</span><br><span class="line">			mIsBeingDragged = false;</span><br><span class="line">			return false;</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">		// 如果手势是正在拖动下拉刷新手势，则处理手势(让onTouchEvent()处理)</span><br><span class="line">		if (action != MotionEvent.ACTION_DOWN &amp;&amp; mIsBeingDragged) &#123;</span><br><span class="line">			return true;</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">		switch (action) &#123;</span><br><span class="line">		case MotionEvent.ACTION_MOVE:</span><br><span class="line">			</span><br><span class="line">			/*</span><br><span class="line">			 * If we&apos;re refreshing, and the flag is set. Eat all MOVE events</span><br><span class="line">			 * 如果正在刷新中...并且不支持刷新过程中滚动事件，则处理</span><br><span class="line">			 */</span><br><span class="line">			if (!mScrollingWhileRefreshingEnabled &amp;&amp; isRefreshing()) &#123;</span><br><span class="line">				return true;</span><br><span class="line">			&#125;</span><br><span class="line">			</span><br><span class="line">			if (isReadyForPull()) &#123; // 准备好可以下拉刷新或上拉刷新</span><br><span class="line">				final float y = event.getY(), x = event.getX();</span><br><span class="line">				final float diff, oppositeDiff, absDiff;</span><br><span class="line"></span><br><span class="line">				/*</span><br><span class="line">				 * We need to use the correct values, based on scroll direction</span><br><span class="line">				 */</span><br><span class="line">				switch (getPullToRefreshScrollDirection()) &#123;</span><br><span class="line">				case HORIZONTAL:</span><br><span class="line">					diff = x - mLastMotionX;</span><br><span class="line">					oppositeDiff = y - mLastMotionY;</span><br><span class="line">					break;</span><br><span class="line">					</span><br><span class="line">				case VERTICAL:</span><br><span class="line">				default:</span><br><span class="line">					diff = y - mLastMotionY;</span><br><span class="line">					oppositeDiff = x - mLastMotionX;</span><br><span class="line">					break;</span><br><span class="line">				&#125;</span><br><span class="line">				absDiff = Math.abs(diff);</span><br><span class="line"></span><br><span class="line">				if (absDiff &gt; mTouchSlop &amp;&amp; (!mFilterTouchEvents || absDiff &gt; Math.abs(oppositeDiff))) &#123;</span><br><span class="line">					</span><br><span class="line">					// 允许下拉刷新，且条件准备好可以下拉刷新了</span><br><span class="line">					if (mMode.showHeaderLoadingLayout() &amp;&amp; diff &gt;= 1f &amp;&amp; isReadyForPullStart()) &#123;</span><br><span class="line">						mLastMotionY = y;</span><br><span class="line">						mLastMotionX = x;</span><br><span class="line">						mIsBeingDragged = true;</span><br><span class="line">						if (mMode == Mode.BOTH) &#123;</span><br><span class="line">							mCurrentMode = Mode.PULL_FROM_START;</span><br><span class="line">						&#125;</span><br><span class="line">					&#125; else if (mMode.showFooterLoadingLayout() &amp;&amp; diff &lt;= -1f &amp;&amp; isReadyForPullEnd()) &#123;</span><br><span class="line">						mLastMotionY = y;</span><br><span class="line">						mLastMotionX = x;</span><br><span class="line">						mIsBeingDragged = true;</span><br><span class="line">						if (mMode == Mode.BOTH) &#123;</span><br><span class="line">							mCurrentMode = Mode.PULL_FROM_END;</span><br><span class="line">						&#125;</span><br><span class="line">					&#125;</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">			break;</span><br><span class="line">		</span><br><span class="line">		case MotionEvent.ACTION_DOWN: // 按下手势不处理，让子View处理</span><br><span class="line">			if (isReadyForPull()) &#123; // 准备好可以上拉刷新或下拉刷新</span><br><span class="line">				mLastMotionY = mInitialMotionY = event.getY();</span><br><span class="line">				mLastMotionX = mInitialMotionX = event.getX();</span><br><span class="line">				mIsBeingDragged = false;</span><br><span class="line">			&#125;</span><br><span class="line">			break;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		return mIsBeingDragged;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	/**</span><br><span class="line">	 * 仅处理上拉/下拉刷新手势事件，其余手势事件在onInterceptTouchEvent()函数中</span><br><span class="line">	 * 已经传递给子View(如ListView等)处理了。这里剩下的就是onInterceptTouchEvent()</span><br><span class="line">	 * 函数过滤过来的上拉/下拉刷新事件。</span><br><span class="line">	 */</span><br><span class="line">	@Override</span><br><span class="line">	public final boolean onTouchEvent(MotionEvent event) &#123;</span><br><span class="line">		if (!isPullToRefreshEnabled()) &#123;</span><br><span class="line">			return false;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		/*</span><br><span class="line">		 * If we&apos;re refreshing, and the flag is set. Eat the event</span><br><span class="line">		 * 如果正在刷新中...并且是刷新过程中不允许滚动事件，则进行空处理。</span><br><span class="line">		 */</span><br><span class="line">		if (!mScrollingWhileRefreshingEnabled &amp;&amp; isRefreshing()) &#123;</span><br><span class="line">			return true;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		if (event.getAction() == MotionEvent.ACTION_DOWN &amp;&amp; event.getEdgeFlags() != 0) &#123;</span><br><span class="line">			return false;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		switch (event.getAction()) &#123;</span><br><span class="line">		case MotionEvent.ACTION_MOVE:</span><br><span class="line">			if (mIsBeingDragged) &#123;</span><br><span class="line">				mLastMotionY = event.getY();</span><br><span class="line">				mLastMotionX = event.getX();</span><br><span class="line">				pullEvent(); // 执行Loading header or footer的滚动事件</span><br><span class="line">				return true;</span><br><span class="line">			&#125;</span><br><span class="line">			break;</span><br><span class="line"></span><br><span class="line">		case MotionEvent.ACTION_DOWN:</span><br><span class="line">			if (isReadyForPull()) &#123;</span><br><span class="line">				mLastMotionY = mInitialMotionY = event.getY();</span><br><span class="line">				mLastMotionX = mInitialMotionX = event.getX();</span><br><span class="line">				return true;</span><br><span class="line">			&#125;</span><br><span class="line">			break;</span><br><span class="line"></span><br><span class="line">		/*</span><br><span class="line">		 * 因为在onInterceptTouchEvent()函数中手势移动事件被处理了，所以之后的抬起事件仍旧在</span><br><span class="line">		 * 此onTouchEvent()事件中处理。</span><br><span class="line">		 * 开启独立线程执行滚动回滚。</span><br><span class="line">		 */</span><br><span class="line">		case MotionEvent.ACTION_CANCEL:</span><br><span class="line">		case MotionEvent.ACTION_UP:</span><br><span class="line">			if (mIsBeingDragged) &#123;</span><br><span class="line">				mIsBeingDragged = false;</span><br><span class="line"></span><br><span class="line">				if (mState == State.RELEASE_TO_REFRESH</span><br><span class="line">						&amp;&amp; (null != mOnRefreshListener || null != mOnRefreshListener2)) &#123;</span><br><span class="line">					</span><br><span class="line">					setState(State.REFRESHING, true);</span><br><span class="line">					return true;</span><br><span class="line">				&#125;</span><br><span class="line"></span><br><span class="line">				// If we&apos;re already refreshing, just scroll back to the top</span><br><span class="line">				if (isRefreshing()) &#123;</span><br><span class="line">					smoothScrollTo(0);</span><br><span class="line">					return true;</span><br><span class="line">				&#125;</span><br><span class="line"></span><br><span class="line">				// If we haven&apos;t returned by here, then we&apos;re not in a state</span><br><span class="line">				// to pull, so just reset</span><br><span class="line">				setState(State.RESET);</span><br><span class="line"></span><br><span class="line">				return true;</span><br><span class="line">			&#125;</span><br><span class="line">			break;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		return false;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	/**</span><br><span class="line">	 * 每次刷新完数据后都调用这个方法重置PullToRefresh</span><br><span class="line">	 */</span><br><span class="line">	@Override</span><br><span class="line">	public final void onRefreshComplete() &#123;</span><br><span class="line">		if (isRefreshing()) &#123;</span><br><span class="line">			setState(State.RESET);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	public final void setScrollingWhileRefreshingEnabled(boolean allowScrollingWhileRefreshing) &#123;</span><br><span class="line">		mScrollingWhileRefreshingEnabled = allowScrollingWhileRefreshing;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	/**</span><br><span class="line">	 * @deprecated See &#123;@link #setScrollingWhileRefreshingEnabled(boolean)&#125;</span><br><span class="line">	 */</span><br><span class="line">	public void setDisableScrollingWhileRefreshing(boolean disableScrollingWhileRefreshing) &#123;</span><br><span class="line">		setScrollingWhileRefreshingEnabled(!disableScrollingWhileRefreshing);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	@Override</span><br><span class="line">	public final void setFilterTouchEvents(boolean filterEvents) &#123;</span><br><span class="line">		mFilterTouchEvents = filterEvents;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	/**</span><br><span class="line">	 * @deprecated You should now call this method on the result of</span><br><span class="line">	 *             &#123;@link #getLoadingLayoutProxy()&#125;.</span><br><span class="line">	 */</span><br><span class="line">	public void setLastUpdatedLabel(CharSequence label) &#123;</span><br><span class="line">		getLoadingLayoutProxy().setLastUpdatedLabel(label);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	/**</span><br><span class="line">	 * @deprecated You should now call this method on the result of</span><br><span class="line">	 *             &#123;@link #getLoadingLayoutProxy()&#125;.</span><br><span class="line">	 */</span><br><span class="line">	public void setLoadingDrawable(Drawable drawable) &#123;</span><br><span class="line">		getLoadingLayoutProxy().setLoadingDrawable(drawable);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	/**</span><br><span class="line">	 * @deprecated You should now call this method on the result of</span><br><span class="line">	 *             &#123;@link #getLoadingLayoutProxy(boolean, boolean)&#125;.</span><br><span class="line">	 */</span><br><span class="line">	public void setLoadingDrawable(Drawable drawable, Mode mode) &#123;</span><br><span class="line">		getLoadingLayoutProxy(mode.showHeaderLoadingLayout(), mode.showFooterLoadingLayout())</span><br><span class="line">				.setLoadingDrawable(drawable);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	@Override</span><br><span class="line">	public void setLongClickable(boolean longClickable) &#123;</span><br><span class="line">		getRefreshableView().setLongClickable(longClickable);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	@Override</span><br><span class="line">	public final void setMode(Mode mode) &#123;</span><br><span class="line">		if (mode != mMode) &#123;</span><br><span class="line">			if (DEBUG) &#123;</span><br><span class="line">				Log.d(LOG_TAG, &quot;Setting mode to: &quot; + mode);</span><br><span class="line">			&#125;</span><br><span class="line">			mMode = mode;</span><br><span class="line">			updateUIForMode(); // 更新PullToRefresh界面</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	public void setOnPullEventListener(OnPullEventListener&lt;T&gt; listener) &#123;</span><br><span class="line">		mOnPullEventListener = listener;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	@Override</span><br><span class="line">	public final void setOnRefreshListener(OnRefreshListener&lt;T&gt; listener) &#123;</span><br><span class="line">		mOnRefreshListener = listener;</span><br><span class="line">		mOnRefreshListener2 = null;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	@Override</span><br><span class="line">	public final void setOnRefreshListener(OnRefreshListener2&lt;T&gt; listener) &#123;</span><br><span class="line">		mOnRefreshListener2 = listener;</span><br><span class="line">		mOnRefreshListener = null;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	/**</span><br><span class="line">	 * @deprecated You should now call this method on the result of</span><br><span class="line">	 *             &#123;@link #getLoadingLayoutProxy()&#125;.</span><br><span class="line">	 */</span><br><span class="line">	public void setPullLabel(CharSequence pullLabel) &#123;</span><br><span class="line">		getLoadingLayoutProxy().setPullLabel(pullLabel);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	/**</span><br><span class="line">	 * @deprecated You should now call this method on the result of</span><br><span class="line">	 *             &#123;@link #getLoadingLayoutProxy(boolean, boolean)&#125;.</span><br><span class="line">	 */</span><br><span class="line">	public void setPullLabel(CharSequence pullLabel, Mode mode) &#123;</span><br><span class="line">		getLoadingLayoutProxy(mode.showHeaderLoadingLayout(), mode.showFooterLoadingLayout())</span><br><span class="line">				.setPullLabel(pullLabel);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	/**</span><br><span class="line">	 * @param enable Whether Pull-To-Refresh should be used</span><br><span class="line">	 * @deprecated This simple calls setMode with an appropriate mode based on</span><br><span class="line">	 *             the passed value.</span><br><span class="line">	 */</span><br><span class="line">	public final void setPullToRefreshEnabled(boolean enable) &#123;</span><br><span class="line">		setMode(enable ? Mode.getDefault() : Mode.DISABLED);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	@Override</span><br><span class="line">	public final void setPullToRefreshOverScrollEnabled(boolean enabled) &#123;</span><br><span class="line">		mOverScrollEnabled = enabled;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	/**</span><br><span class="line">	 * 设置正在刷新</span><br><span class="line">	 */</span><br><span class="line">	@Override</span><br><span class="line">	public final void setRefreshing() &#123;</span><br><span class="line">		setRefreshing(true);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	/**</span><br><span class="line">	 * 设置正在刷新</span><br><span class="line">	 */</span><br><span class="line">	@Override</span><br><span class="line">	public final void setRefreshing(boolean doScroll) &#123;</span><br><span class="line">		if (!isRefreshing()) &#123;</span><br><span class="line">			setState(State.MANUAL_REFRESHING, doScroll);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	/**</span><br><span class="line">	 * @deprecated You should now call this method on the result of</span><br><span class="line">	 *             &#123;@link #getLoadingLayoutProxy()&#125;.</span><br><span class="line">	 */</span><br><span class="line">	public void setRefreshingLabel(CharSequence refreshingLabel) &#123;</span><br><span class="line">		getLoadingLayoutProxy().setRefreshingLabel(refreshingLabel);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	/**</span><br><span class="line">	 * @deprecated You should now call this method on the result of</span><br><span class="line">	 *             &#123;@link #getLoadingLayoutProxy(boolean, boolean)&#125;.</span><br><span class="line">	 */</span><br><span class="line">	public void setRefreshingLabel(CharSequence refreshingLabel, Mode mode) &#123;</span><br><span class="line">		getLoadingLayoutProxy(mode.showHeaderLoadingLayout(), mode.showFooterLoadingLayout())</span><br><span class="line">				.setRefreshingLabel(refreshingLabel);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	/**</span><br><span class="line">	 * @deprecated You should now call this method on the result of</span><br><span class="line">	 *             &#123;@link #getLoadingLayoutProxy()&#125;.</span><br><span class="line">	 */</span><br><span class="line">	public void setReleaseLabel(CharSequence releaseLabel) &#123;</span><br><span class="line">		setReleaseLabel(releaseLabel, Mode.BOTH);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	/**</span><br><span class="line">	 * @deprecated You should now call this method on the result of</span><br><span class="line">	 *             &#123;@link #getLoadingLayoutProxy(boolean, boolean)&#125;.</span><br><span class="line">	 */</span><br><span class="line">	public void setReleaseLabel(CharSequence releaseLabel, Mode mode) &#123;</span><br><span class="line">		getLoadingLayoutProxy(mode.showHeaderLoadingLayout(), mode.showFooterLoadingLayout())</span><br><span class="line">				.setReleaseLabel(releaseLabel);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	public void setScrollAnimationInterpolator(Interpolator interpolator) &#123;</span><br><span class="line">		mScrollAnimationInterpolator = interpolator;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	@Override</span><br><span class="line">	public final void setShowViewWhileRefreshing(boolean showView) &#123;</span><br><span class="line">		mShowViewWhileRefreshing = showView;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	/**</span><br><span class="line">	 * @return Either &#123;@link Orientation#VERTICAL&#125; or</span><br><span class="line">	 *         &#123;@link Orientation#HORIZONTAL&#125; depending on the scroll direction.</span><br><span class="line">	 */</span><br><span class="line">	public abstract Orientation getPullToRefreshScrollDirection(); // TODO</span><br><span class="line"></span><br><span class="line">	final void setState(State state, final boolean... params) &#123;</span><br><span class="line">		mState = state;</span><br><span class="line">		if (DEBUG) &#123;</span><br><span class="line">			Log.d(LOG_TAG, &quot;State: &quot; + mState.name());</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		switch (mState) &#123;</span><br><span class="line">		case RESET:</span><br><span class="line">			onReset();</span><br><span class="line">			break;</span><br><span class="line">			</span><br><span class="line">		case PULL_TO_REFRESH: // 手势拖动更新</span><br><span class="line">			onPullToRefresh();</span><br><span class="line">			break;</span><br><span class="line">			</span><br><span class="line">		case RELEASE_TO_REFRESH: // 释放手势拖动更新</span><br><span class="line">			onReleaseToRefresh();</span><br><span class="line">			break;</span><br><span class="line">			</span><br><span class="line">		case REFRESHING: // 正在刷新中...</span><br><span class="line">		case MANUAL_REFRESHING:</span><br><span class="line">			onRefreshing(params[0]);</span><br><span class="line">			break;</span><br><span class="line">			</span><br><span class="line">		case OVERSCROLLING: // NO-OP</span><br><span class="line">			break;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		// Call OnPullEventListener</span><br><span class="line">		if (null != mOnPullEventListener) &#123;</span><br><span class="line">			mOnPullEventListener.onPullEvent(this, mState, mCurrentMode);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	/**</span><br><span class="line">	 * Used internally for adding view. Need because we override addView to</span><br><span class="line">	 * pass-through to the Refreshable View</span><br><span class="line">	 * 用于把Loading header或loading footer加入到PullToRefresh中</span><br><span class="line">	 */</span><br><span class="line">	protected final void addViewInternal(View child, int index, ViewGroup.LayoutParams params) &#123;</span><br><span class="line">		super.addView(child, index, params);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	/**</span><br><span class="line">	 * Used internally for adding view. Need because we override addView to</span><br><span class="line">	 * pass-through to the Refreshable View</span><br><span class="line">	 * 用于把Refreshable加入到PullToRefresh中，加入到孩子之后</span><br><span class="line">	 */</span><br><span class="line">	protected final void addViewInternal(View child, ViewGroup.LayoutParams params) &#123;</span><br><span class="line">		super.addView(child, -1, params);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	/**</span><br><span class="line">	 * 创建loading header and loading footer</span><br><span class="line">	 * @param context</span><br><span class="line">	 * @param mode 根据mode创建flip样式或rotate样式的loading界面</span><br><span class="line">	 * @param attrs</span><br><span class="line">	 * @return</span><br><span class="line">	 */</span><br><span class="line">	protected LoadingLayout createLoadingLayout(Context context, Mode mode, TypedArray attrs) &#123;</span><br><span class="line">		LoadingLayout layout = mLoadingAnimationStyle.createLoadingLayout(context, mode, </span><br><span class="line">				getPullToRefreshScrollDirection(), attrs);</span><br><span class="line"></span><br><span class="line">		layout.setVisibility(View.INVISIBLE);</span><br><span class="line">		return layout;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	/**</span><br><span class="line">	 * Used internally for &#123;@link #getLoadingLayoutProxy(boolean, boolean)&#125;.</span><br><span class="line">	 * Allows derivative classes to include any extra LoadingLayouts.</span><br><span class="line">	 * 创建Loading界面代理</span><br><span class="line">	 * 获得真正的Loading界面(继承LoadingLayout)</span><br><span class="line">	 */</span><br><span class="line">	protected LoadingLayoutProxy createLoadingLayoutProxy(final boolean includeStart, </span><br><span class="line">			final boolean includeEnd) &#123;</span><br><span class="line"></span><br><span class="line">		LoadingLayoutProxy proxy = new LoadingLayoutProxy();</span><br><span class="line"></span><br><span class="line">		if (includeStart &amp;&amp; mMode.showHeaderLoadingLayout()) &#123;</span><br><span class="line">			proxy.addLayout(mHeaderLayout); // 把loading header加入Loading界面代理</span><br><span class="line">		&#125;</span><br><span class="line">		if (includeEnd &amp;&amp; mMode.showFooterLoadingLayout()) &#123;</span><br><span class="line">			proxy.addLayout(mFooterLayout); // 把loading footer加入Loading界面代理</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		return proxy;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	/**</span><br><span class="line">	 * This is implemented by derived classes to return the created View. If you</span><br><span class="line">	 * need to use a custom View (such as a custom ListView), override this</span><br><span class="line">	 * method and return an instance of your custom class.</span><br><span class="line">	 * &lt;p/&gt;</span><br><span class="line">	 * Be sure to set the ID of the view in this method, especially if you&apos;re</span><br><span class="line">	 * using a ListActivity or ListFragment.</span><br><span class="line">	 * </span><br><span class="line">	 * @param context Context to create view with</span><br><span class="line">	 * @param attrs AttributeSet from wrapped class. Means that anything you</span><br><span class="line">	 *            include in the XML layout declaration will be routed to the</span><br><span class="line">	 *            created View</span><br><span class="line">	 * @return New instance of the Refreshable View</span><br><span class="line">	 */</span><br><span class="line">	protected abstract T createRefreshableView(Context context, AttributeSet attrs); // TODO</span><br><span class="line"></span><br><span class="line">	protected final void disableLoadingLayoutVisibilityChanges() &#123;</span><br><span class="line">		mLayoutVisibilityChangesEnabled = false;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	protected final LoadingLayout getFooterLayout() &#123;</span><br><span class="line">		return mFooterLayout;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	protected final int getFooterSize() &#123;</span><br><span class="line">		return mFooterLayout.getContentSize();</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	protected final LoadingLayout getHeaderLayout() &#123;</span><br><span class="line">		return mHeaderLayout;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	protected final int getHeaderSize() &#123;</span><br><span class="line">		return mHeaderLayout.getContentSize();</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	protected int getPullToRefreshScrollDuration() &#123;</span><br><span class="line">		return SMOOTH_SCROLL_DURATION_MS;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	protected int getPullToRefreshScrollDurationLonger() &#123;</span><br><span class="line">		return SMOOTH_SCROLL_LONG_DURATION_MS;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	protected FrameLayout getRefreshableViewWrapper() &#123;</span><br><span class="line">		return mRefreshableViewWrapper;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	/**</span><br><span class="line">	 * Allows Derivative classes to handle the XML Attrs without creating a</span><br><span class="line">	 * TypedArray themsevles</span><br><span class="line">	 * </span><br><span class="line">	 * @param a - TypedArray of PullToRefresh Attributes</span><br><span class="line">	 */</span><br><span class="line">	protected void handleStyledAttributes(TypedArray a) &#123;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	/**</span><br><span class="line">	 * Implemented by derived class to return whether the View is in a state</span><br><span class="line">	 * where the user can Pull to Refresh by scrolling from the end.</span><br><span class="line">	 * </span><br><span class="line">	 * @return true if the View is currently in the correct state (for example,</span><br><span class="line">	 *         bottom of a ListView)</span><br><span class="line">	 */</span><br><span class="line">	protected abstract boolean isReadyForPullEnd();</span><br><span class="line"></span><br><span class="line">	/**</span><br><span class="line">	 * Implemented by derived class to return whether the View is in a state</span><br><span class="line">	 * where the user can Pull to Refresh by scrolling from the start.</span><br><span class="line">	 * </span><br><span class="line">	 * @return true if the View is currently the correct state (for example, top</span><br><span class="line">	 *         of a ListView)</span><br><span class="line">	 */</span><br><span class="line">	protected abstract boolean isReadyForPullStart();</span><br><span class="line"></span><br><span class="line">	/**</span><br><span class="line">	 * Called by &#123;@link #onRestoreInstanceState(Parcelable)&#125; so that derivative</span><br><span class="line">	 * classes can handle their saved instance state.</span><br><span class="line">	 * </span><br><span class="line">	 * @param savedInstanceState - Bundle which contains saved instance state.</span><br><span class="line">	 */</span><br><span class="line">	protected void onPtrRestoreInstanceState(Bundle savedInstanceState) &#123;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	/**</span><br><span class="line">	 * Called by &#123;@link #onSaveInstanceState()&#125; so that derivative classes can</span><br><span class="line">	 * save their instance state.</span><br><span class="line">	 * </span><br><span class="line">	 * @param saveState - Bundle to be updated with saved state.</span><br><span class="line">	 */</span><br><span class="line">	protected void onPtrSaveInstanceState(Bundle saveState) &#123;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	/**</span><br><span class="line">	 * Called when the UI has been to be updated to be in the</span><br><span class="line">	 * &#123;@link State#PULL_TO_REFRESH&#125; state.</span><br><span class="line">	 */</span><br><span class="line">	protected void onPullToRefresh() &#123;</span><br><span class="line">		switch (mCurrentMode) &#123;</span><br><span class="line">		case PULL_FROM_END:</span><br><span class="line">			mFooterLayout.pullToRefresh();</span><br><span class="line">			break;</span><br><span class="line">			</span><br><span class="line">		case PULL_FROM_START:</span><br><span class="line">			mHeaderLayout.pullToRefresh();</span><br><span class="line">			break;</span><br><span class="line">			</span><br><span class="line">		default:</span><br><span class="line">			// NO-OP</span><br><span class="line">			break;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	/**</span><br><span class="line">	 * Called when the UI has been to be updated to be in the</span><br><span class="line">	 * &#123;@link State#REFRESHING&#125; or &#123;@link State#MANUAL_REFRESHING&#125; state.</span><br><span class="line">	 * 正在刷新的回调函数</span><br><span class="line">	 * </span><br><span class="line">	 * @param doScroll - Whether the UI should scroll for this event.</span><br><span class="line">	 */</span><br><span class="line">	protected void onRefreshing(final boolean doScroll) &#123;</span><br><span class="line">		if (mMode.showHeaderLoadingLayout()) &#123; // 允许下拉刷新</span><br><span class="line">			mHeaderLayout.refreshing();</span><br><span class="line">		&#125;</span><br><span class="line">		if (mMode.showFooterLoadingLayout()) &#123; // 允许上拉刷新</span><br><span class="line">			mFooterLayout.refreshing();</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		if (doScroll) &#123; // 上/下拉刷新的时候允许UI滚动事件</span><br><span class="line">			if (mShowViewWhileRefreshing) &#123;</span><br><span class="line"></span><br><span class="line">				// Call Refresh Listener when the Scroll has finished</span><br><span class="line">				OnSmoothScrollFinishedListener listener = new OnSmoothScrollFinishedListener() &#123;</span><br><span class="line">					@Override</span><br><span class="line">					public void onSmoothScrollFinished() &#123;</span><br><span class="line">						callRefreshListener();</span><br><span class="line">					&#125;</span><br><span class="line">				&#125;;</span><br><span class="line"></span><br><span class="line">				switch (mCurrentMode) &#123;</span><br><span class="line">				case MANUAL_REFRESH_ONLY:</span><br><span class="line">				case PULL_FROM_END: // 子线程中的滚动动画</span><br><span class="line">					smoothScrollTo(getFooterSize(), listener);</span><br><span class="line">					break;</span><br><span class="line">					</span><br><span class="line">				default:</span><br><span class="line">				case PULL_FROM_START:</span><br><span class="line">					smoothScrollTo(-getHeaderSize(), listener);</span><br><span class="line">					break;</span><br><span class="line">				&#125;</span><br><span class="line">			&#125; else &#123;</span><br><span class="line">				smoothScrollTo(0);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125; else &#123;</span><br><span class="line">			// We&apos;re not scrolling, so just call Refresh Listener now</span><br><span class="line">			callRefreshListener();</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	/**</span><br><span class="line">	 * Called when the UI has been to be updated to be in the</span><br><span class="line">	 * &#123;@link State#RELEASE_TO_REFRESH&#125; state.</span><br><span class="line">	 */</span><br><span class="line">	protected void onReleaseToRefresh() &#123;</span><br><span class="line">		switch (mCurrentMode) &#123;</span><br><span class="line">		case PULL_FROM_END:</span><br><span class="line">			mFooterLayout.releaseToRefresh();</span><br><span class="line">			break;</span><br><span class="line">			</span><br><span class="line">		case PULL_FROM_START:</span><br><span class="line">			mHeaderLayout.releaseToRefresh();</span><br><span class="line">			break;</span><br><span class="line">			</span><br><span class="line">		default:</span><br><span class="line">			// NO-OP</span><br><span class="line">			break;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	/**</span><br><span class="line">	 * Called when the UI has been to be updated to be in the</span><br><span class="line">	 * &#123;@link State#RESET&#125; state.</span><br><span class="line">	 */</span><br><span class="line">	protected void onReset() &#123;</span><br><span class="line">		mIsBeingDragged = false;</span><br><span class="line">		mLayoutVisibilityChangesEnabled = true;</span><br><span class="line"></span><br><span class="line">		// Always reset both layouts, just in case...</span><br><span class="line">		mHeaderLayout.reset();</span><br><span class="line">		mFooterLayout.reset();</span><br><span class="line"></span><br><span class="line">		smoothScrollTo(0);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	@Override</span><br><span class="line">	protected final void onRestoreInstanceState(Parcelable state) &#123;</span><br><span class="line">		if (state instanceof Bundle) &#123;</span><br><span class="line">			Bundle bundle = (Bundle) state;</span><br><span class="line"></span><br><span class="line">			setMode(Mode.mapIntToValue(bundle.getInt(STATE_MODE, 0)));</span><br><span class="line">			mCurrentMode = Mode.mapIntToValue(bundle.getInt(STATE_CURRENT_MODE, 0));</span><br><span class="line"></span><br><span class="line">			mScrollingWhileRefreshingEnabled = bundle.getBoolean(STATE_SCROLLING_REFRESHING_ENABLED, false);</span><br><span class="line">			mShowViewWhileRefreshing = bundle.getBoolean(STATE_SHOW_REFRESHING_VIEW, true);</span><br><span class="line"></span><br><span class="line">			// Let super Restore Itself</span><br><span class="line">			super.onRestoreInstanceState(bundle.getParcelable(STATE_SUPER));</span><br><span class="line"></span><br><span class="line">			State viewState = State.mapIntToValue(bundle.getInt(STATE_STATE, 0));</span><br><span class="line">			if (viewState == State.REFRESHING || viewState == State.MANUAL_REFRESHING) &#123;</span><br><span class="line">				setState(viewState, true);</span><br><span class="line">			&#125;</span><br><span class="line"></span><br><span class="line">			// Now let derivative classes restore their state</span><br><span class="line">			onPtrRestoreInstanceState(bundle);</span><br><span class="line">			return;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		super.onRestoreInstanceState(state);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	@Override</span><br><span class="line">	protected final Parcelable onSaveInstanceState() &#123;</span><br><span class="line">		Bundle bundle = new Bundle();</span><br><span class="line"></span><br><span class="line">		// Let derivative classes get a chance to save state first, that way we</span><br><span class="line">		// can make sure they don&apos;t overrite any of our values</span><br><span class="line">		onPtrSaveInstanceState(bundle);</span><br><span class="line"></span><br><span class="line">		bundle.putInt(STATE_STATE, mState.getIntValue());</span><br><span class="line">		bundle.putInt(STATE_MODE, mMode.getIntValue());</span><br><span class="line">		bundle.putInt(STATE_CURRENT_MODE, mCurrentMode.getIntValue());</span><br><span class="line">		bundle.putBoolean(STATE_SCROLLING_REFRESHING_ENABLED, mScrollingWhileRefreshingEnabled);</span><br><span class="line">		bundle.putBoolean(STATE_SHOW_REFRESHING_VIEW, mShowViewWhileRefreshing);</span><br><span class="line">		bundle.putParcelable(STATE_SUPER, super.onSaveInstanceState());</span><br><span class="line"></span><br><span class="line">		return bundle;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	@Override</span><br><span class="line">	protected final void onSizeChanged(int w, int h, int oldw, int oldh) &#123;</span><br><span class="line">		if (DEBUG) &#123;</span><br><span class="line">			Log.d(LOG_TAG, String.format(&quot;onSizeChanged. W: %d, H: %d&quot;, w, h));</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		super.onSizeChanged(w, h, oldw, oldh);</span><br><span class="line"></span><br><span class="line">		// We need to update the header/footer when our size changes</span><br><span class="line">		refreshLoadingViewsSize();</span><br><span class="line"></span><br><span class="line">		// Update the Refreshable View layout</span><br><span class="line">		refreshRefreshableViewSize(w, h);</span><br><span class="line"></span><br><span class="line">		/**</span><br><span class="line">		 * As we&apos;re currently in a Layout Pass, we need to schedule another one</span><br><span class="line">		 * to layout any changes we&apos;ve made here</span><br><span class="line">		 */</span><br><span class="line">		post(new Runnable() &#123;</span><br><span class="line">			@Override</span><br><span class="line">			public void run() &#123;</span><br><span class="line">				requestLayout();</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	/**</span><br><span class="line">	 * Re-measure the Loading Views height, and adjust internal padding as</span><br><span class="line">	 * necessary</span><br><span class="line">	 * 设置loading header and footer视图大小、隐藏它们到顶部栏or底部栏后面</span><br><span class="line">	 */</span><br><span class="line">	protected final void refreshLoadingViewsSize() &#123;</span><br><span class="line">		final int maximumPullScroll = (int) (getMaximumPullScroll() * 1.2f);</span><br><span class="line"></span><br><span class="line">		int pLeft = getPaddingLeft();</span><br><span class="line">		int pTop = getPaddingTop();</span><br><span class="line">		int pRight = getPaddingRight();</span><br><span class="line">		int pBottom = getPaddingBottom();</span><br><span class="line"></span><br><span class="line">		switch (getPullToRefreshScrollDirection()) &#123; // TODO</span><br><span class="line">		case HORIZONTAL:</span><br><span class="line">			if (mMode.showHeaderLoadingLayout()) &#123;</span><br><span class="line">				mHeaderLayout.setWidth(maximumPullScroll);</span><br><span class="line">				pLeft = -maximumPullScroll;</span><br><span class="line">			&#125; else &#123;</span><br><span class="line">				pLeft = 0;</span><br><span class="line">			&#125;</span><br><span class="line"></span><br><span class="line">			if (mMode.showFooterLoadingLayout()) &#123;</span><br><span class="line">				mFooterLayout.setWidth(maximumPullScroll);</span><br><span class="line">				pRight = -maximumPullScroll;</span><br><span class="line">			&#125; else &#123;</span><br><span class="line">				pRight = 0;</span><br><span class="line">			&#125;</span><br><span class="line">			break;</span><br><span class="line"></span><br><span class="line">		case VERTICAL:</span><br><span class="line">			if (mMode.showHeaderLoadingLayout()) &#123;</span><br><span class="line">				mHeaderLayout.setHeight(maximumPullScroll); // 设置loading header高度</span><br><span class="line">				pTop = -maximumPullScroll; // 把loading header塞到顶部栏之后的距离参数</span><br><span class="line">			&#125; else &#123;</span><br><span class="line">				pTop = 0;</span><br><span class="line">			&#125;</span><br><span class="line"></span><br><span class="line">			if (mMode.showFooterLoadingLayout()) &#123;</span><br><span class="line">				mFooterLayout.setHeight(maximumPullScroll); // 设置loading footer高度</span><br><span class="line">				pBottom = -maximumPullScroll;</span><br><span class="line">			&#125; else &#123;</span><br><span class="line">				pBottom = 0;</span><br><span class="line">			&#125;</span><br><span class="line">			break;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		if (DEBUG) &#123;</span><br><span class="line">			Log.d(LOG_TAG, String.format(&quot;Setting Padding. L: %d, T: %d, R: %d, B: %d&quot;, </span><br><span class="line">					pLeft, pTop, pRight, pBottom));</span><br><span class="line">		&#125;</span><br><span class="line">		setPadding(pLeft, pTop, pRight, pBottom); // 把loading header or footer塞到顶部栏or底部栏之后</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	protected final void refreshRefreshableViewSize(int width, int height) &#123;</span><br><span class="line">		</span><br><span class="line">		// We need to set the Height of the Refreshable View to the same as</span><br><span class="line">		// this layout</span><br><span class="line">		LinearLayout.LayoutParams lp = </span><br><span class="line">				(LinearLayout.LayoutParams) mRefreshableViewWrapper.getLayoutParams();</span><br><span class="line"></span><br><span class="line">		switch (getPullToRefreshScrollDirection()) &#123;</span><br><span class="line">		case HORIZONTAL:</span><br><span class="line">			if (lp.width != width) &#123;</span><br><span class="line">				lp.width = width;</span><br><span class="line">				mRefreshableViewWrapper.requestLayout();</span><br><span class="line">			&#125;</span><br><span class="line">			break;</span><br><span class="line">			</span><br><span class="line">		case VERTICAL:</span><br><span class="line">			if (lp.height != height) &#123;</span><br><span class="line">				lp.height = height;</span><br><span class="line">				mRefreshableViewWrapper.requestLayout();</span><br><span class="line">			&#125;</span><br><span class="line">			break;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	/**</span><br><span class="line">	 * Helper method which just calls scrollTo() in the correct scrolling</span><br><span class="line">	 * direction.</span><br><span class="line">	 * 设置界面滚动到合适的位置，当手势拖动时直接调用这个函数；当释放拖动手势时把</span><br><span class="line">	 * 该函数放在一个独立线程中执行。</span><br><span class="line">	 * @param value - New Scroll value</span><br><span class="line">	 */</span><br><span class="line">	protected final void setHeaderScroll(int value) &#123;</span><br><span class="line">		if (DEBUG) &#123;</span><br><span class="line">			Log.d(LOG_TAG, &quot;setHeaderScroll: &quot; + value);</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		// Clamp value to with pull scroll range</span><br><span class="line">		final int maximumPullScroll = getMaximumPullScroll();</span><br><span class="line">		value = Math.min(maximumPullScroll, Math.max(-maximumPullScroll, value));</span><br><span class="line"></span><br><span class="line">		if (mLayoutVisibilityChangesEnabled) &#123;</span><br><span class="line">			if (value &lt; 0) &#123;</span><br><span class="line">				mHeaderLayout.setVisibility(View.VISIBLE);</span><br><span class="line">			&#125; else if (value &gt; 0) &#123;</span><br><span class="line">				mFooterLayout.setVisibility(View.VISIBLE);</span><br><span class="line">			&#125; else &#123;</span><br><span class="line">				mHeaderLayout.setVisibility(View.INVISIBLE);</span><br><span class="line">				mFooterLayout.setVisibility(View.INVISIBLE);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		if (USE_HW_LAYERS) &#123;</span><br><span class="line">			/**</span><br><span class="line">			 * Use a Hardware Layer on the Refreshable View if we&apos;ve scrolled at</span><br><span class="line">			 * all. We don&apos;t use them on the Header/Footer Views as they change</span><br><span class="line">			 * often, which would negate any HW layer performance boost.</span><br><span class="line">			 */</span><br><span class="line">			ViewCompat.setLayerType(mRefreshableViewWrapper, value != 0 ? </span><br><span class="line">					View.LAYER_TYPE_HARDWARE : View.LAYER_TYPE_NONE);</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		switch (getPullToRefreshScrollDirection()) &#123;</span><br><span class="line">		case VERTICAL:</span><br><span class="line">			scrollTo(0, value);</span><br><span class="line">			break;</span><br><span class="line">			</span><br><span class="line">		case HORIZONTAL:</span><br><span class="line">			scrollTo(value, 0);</span><br><span class="line">			break;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	/**</span><br><span class="line">	 * Smooth Scroll to position using the default duration of</span><br><span class="line">	 * &#123;@value #SMOOTH_SCROLL_DURATION_MS&#125; ms.</span><br><span class="line">	 * </span><br><span class="line">	 * @param scrollValue - Position to scroll to</span><br><span class="line">	 */</span><br><span class="line">	protected final void smoothScrollTo(int scrollValue) &#123;</span><br><span class="line">		smoothScrollTo(scrollValue, getPullToRefreshScrollDuration());</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	/**</span><br><span class="line">	 * Smooth Scroll to position using the default duration of</span><br><span class="line">	 * &#123;@value #SMOOTH_SCROLL_DURATION_MS&#125; ms.</span><br><span class="line">	 * </span><br><span class="line">	 * @param scrollValue - Position to scroll to</span><br><span class="line">	 * @param listener - Listener for scroll</span><br><span class="line">	 */</span><br><span class="line">	protected final void smoothScrollTo(int scrollValue, OnSmoothScrollFinishedListener listener) &#123;</span><br><span class="line">		smoothScrollTo(scrollValue, getPullToRefreshScrollDuration(), 0, listener);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	/**</span><br><span class="line">	 * Smooth Scroll to position using the longer default duration of</span><br><span class="line">	 * &#123;@value #SMOOTH_SCROLL_LONG_DURATION_MS&#125; ms.</span><br><span class="line">	 * </span><br><span class="line">	 * @param scrollValue - Position to scroll to</span><br><span class="line">	 */</span><br><span class="line">	protected final void smoothScrollToLonger(int scrollValue) &#123;</span><br><span class="line">		smoothScrollTo(scrollValue, getPullToRefreshScrollDurationLonger());</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	/**</span><br><span class="line">	 * Updates the View State when the mode has been set. This does not do any</span><br><span class="line">	 * checking that the mode is different to current state so always updates.</span><br><span class="line">	 * 更新PullToRefresh界面</span><br><span class="line">	 */</span><br><span class="line">	protected void updateUIForMode() &#123;</span><br><span class="line">		</span><br><span class="line">		// We need to use the correct LayoutParam values, based on scroll</span><br><span class="line">		// direction</span><br><span class="line">		final LinearLayout.LayoutParams lp = getLoadingLayoutLayoutParams();</span><br><span class="line"></span><br><span class="line">		// Remove Header, and then add Header Loading View again if needed</span><br><span class="line">		if (this == mHeaderLayout.getParent()) &#123;</span><br><span class="line">			removeView(mHeaderLayout);</span><br><span class="line">		&#125;</span><br><span class="line">		if (mMode.showHeaderLoadingLayout()) &#123;</span><br><span class="line">			addViewInternal(mHeaderLayout, 0, lp); // 把loading header加入到PullToRefresh</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		// Remove Footer, and then add Footer Loading View again if needed</span><br><span class="line">		if (this == mFooterLayout.getParent()) &#123;</span><br><span class="line">			removeView(mFooterLayout);</span><br><span class="line">		&#125;</span><br><span class="line">		if (mMode.showFooterLoadingLayout()) &#123;</span><br><span class="line">			addViewInternal(mFooterLayout, lp); // 把loading footer加入到PullToRefresh</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		// Hide Loading Views 把loading header or footer隐藏到顶部栏or底部栏之后</span><br><span class="line">		refreshLoadingViewsSize();</span><br><span class="line"></span><br><span class="line">		// If we&apos;re not using Mode.BOTH, set mCurrentMode to mMode, otherwise</span><br><span class="line">		// set it to pull down</span><br><span class="line">		mCurrentMode = (mMode != Mode.BOTH) ? mMode : Mode.PULL_FROM_START;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	/**</span><br><span class="line">	 * 把Refresh View(ListView/GridView等)加入到PullToRefresh中</span><br><span class="line">	 * @param context</span><br><span class="line">	 * @param refreshableView</span><br><span class="line">	 */</span><br><span class="line">	private void addRefreshableView(Context context, T refreshableView) &#123;</span><br><span class="line">		mRefreshableViewWrapper = new FrameLayout(context);</span><br><span class="line">		mRefreshableViewWrapper.addView(refreshableView, ViewGroup.LayoutParams.MATCH_PARENT,</span><br><span class="line">				ViewGroup.LayoutParams.MATCH_PARENT);</span><br><span class="line"></span><br><span class="line">		addViewInternal(mRefreshableViewWrapper, </span><br><span class="line">				new LinearLayout.LayoutParams(LayoutParams.MATCH_PARENT, LayoutParams.MATCH_PARENT));</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	private void callRefreshListener() &#123;</span><br><span class="line">		if (null != mOnRefreshListener) &#123;</span><br><span class="line">			mOnRefreshListener.onRefresh(this);</span><br><span class="line">		&#125; else if (null != mOnRefreshListener2) &#123;</span><br><span class="line">			if (mCurrentMode == Mode.PULL_FROM_START) &#123;</span><br><span class="line">				mOnRefreshListener2.onPullDownToRefresh(this);</span><br><span class="line">			&#125; else if (mCurrentMode == Mode.PULL_FROM_END) &#123;</span><br><span class="line">				mOnRefreshListener2.onPullUpToRefresh(this);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	/*</span><br><span class="line">	 * 初始化PullToRefresh界面基本框架</span><br><span class="line">	 */</span><br><span class="line">	@SuppressWarnings(&quot;deprecation&quot;)</span><br><span class="line">	private void init(Context context, AttributeSet attrs) &#123;</span><br><span class="line">		switch (getPullToRefreshScrollDirection()) &#123;</span><br><span class="line">		case HORIZONTAL:</span><br><span class="line">			setOrientation(LinearLayout.HORIZONTAL);</span><br><span class="line">			break;</span><br><span class="line">			</span><br><span class="line">		case VERTICAL:</span><br><span class="line">		default:</span><br><span class="line">			setOrientation(LinearLayout.VERTICAL);</span><br><span class="line">			break;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		setGravity(Gravity.CENTER);</span><br><span class="line"></span><br><span class="line">		// 拖动手势的最小识别距离</span><br><span class="line">		ViewConfiguration config = ViewConfiguration.get(context);</span><br><span class="line">		mTouchSlop = config.getScaledTouchSlop();</span><br><span class="line"></span><br><span class="line">		// Styleables from XML</span><br><span class="line">		TypedArray a = context.obtainStyledAttributes(attrs, R.styleable.PullToRefresh);</span><br><span class="line">		</span><br><span class="line">		if (a.hasValue(R.styleable.PullToRefresh_ptrMode)) &#123;</span><br><span class="line">			mMode = Mode.mapIntToValue(a.getInteger(R.styleable.PullToRefresh_ptrMode, 0));</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">		if (a.hasValue(R.styleable.PullToRefresh_ptrAnimationStyle)) &#123;</span><br><span class="line">			mLoadingAnimationStyle = AnimationStyle.mapIntToValue(a.getInteger(</span><br><span class="line">					R.styleable.PullToRefresh_ptrAnimationStyle, 0));</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">		/*</span><br><span class="line">		 * Refreshable View，把Refreshable View加入到PullToRefresh界面(LinearLayout)中，</span><br><span class="line">		 * By passing the attrs, we can add ListView/GridView params via XML</span><br><span class="line">		 */</span><br><span class="line">		mRefreshableView = createRefreshableView(context, attrs); // TODO</span><br><span class="line">		addRefreshableView(context, mRefreshableView);</span><br><span class="line"></span><br><span class="line">		/*</span><br><span class="line">		 * We need to create now layouts now，这两个在刚开始创建PullToRefresh的时，就已经</span><br><span class="line">		 * 根据Mode方向将其加入到了PullToRefresh中了，只是被隐藏在了顶部栏或底部栏之后了。</span><br><span class="line">		 * 因此上拉或下拉的时，只是把loading header或loading footer从其中显示出来而已。</span><br><span class="line">		 */</span><br><span class="line">		mHeaderLayout = createLoadingLayout(context, Mode.PULL_FROM_START, a);</span><br><span class="line">		mFooterLayout = createLoadingLayout(context, Mode.PULL_FROM_END, a);</span><br><span class="line"></span><br><span class="line">		/**</span><br><span class="line">		 * Styleables from XML</span><br><span class="line">		 */</span><br><span class="line">		if (a.hasValue(R.styleable.PullToRefresh_ptrRefreshableViewBackground)) &#123;</span><br><span class="line">			Drawable background = a.getDrawable(R.styleable.PullToRefresh_ptrRefreshableViewBackground);</span><br><span class="line">			if (null != background) &#123;</span><br><span class="line">				mRefreshableView.setBackgroundDrawable(background);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125; else if (a.hasValue(R.styleable.PullToRefresh_ptrAdapterViewBackground)) &#123;</span><br><span class="line">			Utils.warnDeprecation(&quot;ptrAdapterViewBackground&quot;, &quot;ptrRefreshableViewBackground&quot;);</span><br><span class="line">			Drawable background = a.getDrawable(R.styleable.PullToRefresh_ptrAdapterViewBackground);</span><br><span class="line">			if (null != background) &#123;</span><br><span class="line">				mRefreshableView.setBackgroundDrawable(background);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		if (a.hasValue(R.styleable.PullToRefresh_ptrOverScroll)) &#123;</span><br><span class="line">			mOverScrollEnabled = a.getBoolean(R.styleable.PullToRefresh_ptrOverScroll, true);</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		if (a.hasValue(R.styleable.PullToRefresh_ptrScrollingWhileRefreshingEnabled)) &#123;</span><br><span class="line">			mScrollingWhileRefreshingEnabled = </span><br><span class="line">					a.getBoolean(R.styleable.PullToRefresh_ptrScrollingWhileRefreshingEnabled, false);</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		// Let the derivative classes have a go at handling attributes, then</span><br><span class="line">		// recycle them...</span><br><span class="line">		handleStyledAttributes(a);</span><br><span class="line">		a.recycle();</span><br><span class="line"></span><br><span class="line">		// Finally update the UI for the modes，上面是获得相关属性和子界面，这里是更新PullToRefresh界面</span><br><span class="line">		updateUIForMode();</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	/*</span><br><span class="line">	 * 控件是否可以下拉刷新或上拉刷新</span><br><span class="line">	 */</span><br><span class="line">	private boolean isReadyForPull() &#123;</span><br><span class="line">		switch (mMode) &#123;</span><br><span class="line">		case PULL_FROM_START:</span><br><span class="line">			return isReadyForPullStart(); // TODO: 让子类来实现下拉刷新的时机</span><br><span class="line">		case PULL_FROM_END:</span><br><span class="line">			return isReadyForPullEnd(); // TODO: 让子类来实现上拉刷新的时机</span><br><span class="line">		case BOTH:</span><br><span class="line">			return isReadyForPullEnd() || isReadyForPullStart();</span><br><span class="line">		default:</span><br><span class="line">			return false;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	/*</span><br><span class="line">	 * Actions a Pull Event 手势下/上拉事件</span><br><span class="line">	 * @return true if the Event has been handled, false if there has been no</span><br><span class="line">	 * change</span><br><span class="line">	 * 执行滚动事件</span><br><span class="line">	 */</span><br><span class="line">	private void pullEvent() &#123;</span><br><span class="line">		final int newScrollValue;</span><br><span class="line">		final int itemDimension;</span><br><span class="line">		final float initialMotionValue, lastMotionValue;</span><br><span class="line"></span><br><span class="line">		switch (getPullToRefreshScrollDirection()) &#123;</span><br><span class="line">		case HORIZONTAL:</span><br><span class="line">			initialMotionValue = mInitialMotionX;</span><br><span class="line">			lastMotionValue = mLastMotionX;</span><br><span class="line">			break;</span><br><span class="line"></span><br><span class="line">		case VERTICAL:</span><br><span class="line">		default:</span><br><span class="line">			initialMotionValue = mInitialMotionY;</span><br><span class="line">			lastMotionValue = mLastMotionY;</span><br><span class="line">			break;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		switch (mCurrentMode) &#123;</span><br><span class="line">		case PULL_FROM_END:</span><br><span class="line">			newScrollValue = Math.round(Math.max(initialMotionValue - lastMotionValue, 0) / FRICTION);</span><br><span class="line">			itemDimension = getFooterSize();</span><br><span class="line">			break;</span><br><span class="line">			</span><br><span class="line">		case PULL_FROM_START:</span><br><span class="line">		default:</span><br><span class="line">			newScrollValue = Math.round(Math.min(initialMotionValue - lastMotionValue, 0) / FRICTION);</span><br><span class="line">			itemDimension = getHeaderSize();</span><br><span class="line">			break;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		setHeaderScroll(newScrollValue); // 设置laoding header滚动到指定位置</span><br><span class="line"></span><br><span class="line">		if (newScrollValue != 0 &amp;&amp; !isRefreshing()) &#123;</span><br><span class="line">			float scale = Math.abs(newScrollValue) / (float) itemDimension;</span><br><span class="line">			switch (mCurrentMode) &#123;</span><br><span class="line">			case PULL_FROM_END:</span><br><span class="line">				mFooterLayout.onPull(scale);</span><br><span class="line">				break;</span><br><span class="line">				</span><br><span class="line">			case PULL_FROM_START:</span><br><span class="line">			default:</span><br><span class="line">				mHeaderLayout.onPull(scale);</span><br><span class="line">				break;</span><br><span class="line">			&#125;</span><br><span class="line"></span><br><span class="line">			if (mState != State.PULL_TO_REFRESH &amp;&amp; itemDimension &gt;= Math.abs(newScrollValue)) &#123;</span><br><span class="line">				setState(State.PULL_TO_REFRESH);</span><br><span class="line">			&#125; else if (mState == State.PULL_TO_REFRESH &amp;&amp; itemDimension &lt; Math.abs(newScrollValue)) &#123;</span><br><span class="line">				setState(State.RELEASE_TO_REFRESH);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	/*</span><br><span class="line">	 * 获得loading header or footer布局参数</span><br><span class="line">	 */</span><br><span class="line">	private LinearLayout.LayoutParams getLoadingLayoutLayoutParams() &#123;</span><br><span class="line">		switch (getPullToRefreshScrollDirection()) &#123; // TODO</span><br><span class="line">		case HORIZONTAL:</span><br><span class="line">			return new LinearLayout.LayoutParams(LinearLayout.LayoutParams.WRAP_CONTENT,</span><br><span class="line">					LinearLayout.LayoutParams.MATCH_PARENT);</span><br><span class="line">			</span><br><span class="line">		case VERTICAL:</span><br><span class="line">		default:</span><br><span class="line">			return new LinearLayout.LayoutParams(LinearLayout.LayoutParams.MATCH_PARENT,</span><br><span class="line">					LinearLayout.LayoutParams.WRAP_CONTENT);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	/*</span><br><span class="line">	 * 获取上拉和下拉最大滚动距离</span><br><span class="line">	 */</span><br><span class="line">	private int getMaximumPullScroll() &#123;</span><br><span class="line">		switch (getPullToRefreshScrollDirection()) &#123; //TODO</span><br><span class="line">		case HORIZONTAL:</span><br><span class="line">			return Math.round(getWidth() / FRICTION); // 最大滚动距离是宽度的一半</span><br><span class="line">			</span><br><span class="line">		case VERTICAL:</span><br><span class="line">		default:</span><br><span class="line">			return Math.round(getHeight() / FRICTION); // 最大滚动距离是高度的一半</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	/**</span><br><span class="line">	 * Smooth Scroll to position using the specific duration</span><br><span class="line">	 * </span><br><span class="line">	 * @param scrollValue - Position to scroll to</span><br><span class="line">	 * @param duration - Duration of animation in milliseconds</span><br><span class="line">	 */</span><br><span class="line">	private final void smoothScrollTo(int scrollValue, long duration) &#123;</span><br><span class="line">		smoothScrollTo(scrollValue, duration, 0, null);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	/*</span><br><span class="line">	 * 平滑滚动，在独立线程中执行</span><br><span class="line">	 */</span><br><span class="line">	private final void smoothScrollTo(int newScrollValue, long duration, long delayMillis, </span><br><span class="line">			OnSmoothScrollFinishedListener listener) &#123;</span><br><span class="line">		</span><br><span class="line">		if (null != mCurrentSmoothScrollRunnable) &#123;</span><br><span class="line">			mCurrentSmoothScrollRunnable.stop();</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		final int oldScrollValue;</span><br><span class="line">		switch (getPullToRefreshScrollDirection()) &#123; // TODO</span><br><span class="line">		case HORIZONTAL:</span><br><span class="line">			oldScrollValue = getScrollX();</span><br><span class="line">			break;</span><br><span class="line">			</span><br><span class="line">		case VERTICAL:</span><br><span class="line">		default:</span><br><span class="line">			oldScrollValue = getScrollY();</span><br><span class="line">			break;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		if (oldScrollValue != newScrollValue) &#123;</span><br><span class="line">			if (null == mScrollAnimationInterpolator) &#123;</span><br><span class="line">				</span><br><span class="line">				// Default interpolator is a Decelerate Interpolator</span><br><span class="line">				mScrollAnimationInterpolator = new DecelerateInterpolator();</span><br><span class="line">			&#125;</span><br><span class="line">			mCurrentSmoothScrollRunnable = </span><br><span class="line">					new SmoothScrollRunnable(oldScrollValue, newScrollValue, duration, listener);</span><br><span class="line"></span><br><span class="line">			if (delayMillis &gt; 0) &#123;</span><br><span class="line">				postDelayed(mCurrentSmoothScrollRunnable, delayMillis);</span><br><span class="line">			&#125; else &#123;</span><br><span class="line">				post(mCurrentSmoothScrollRunnable);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	private final void smoothScrollToAndBack(int y) &#123;</span><br><span class="line">		smoothScrollTo(y, SMOOTH_SCROLL_DURATION_MS, 0, new OnSmoothScrollFinishedListener() &#123;</span><br><span class="line"></span><br><span class="line">			@Override</span><br><span class="line">			public void onSmoothScrollFinished() &#123;</span><br><span class="line">				smoothScrollTo(0, SMOOTH_SCROLL_DURATION_MS, DEMO_SCROLL_INTERVAL, null);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	/**</span><br><span class="line">	 * 动画样式</span><br><span class="line">	 */</span><br><span class="line">	public static enum AnimationStyle &#123;</span><br><span class="line">		</span><br><span class="line">		/**</span><br><span class="line">		 * This is the default for Android-PullToRefresh. Allows you to use any</span><br><span class="line">		 * drawable, which is automatically rotated and used as a Progress Bar.</span><br><span class="line">		 */</span><br><span class="line">		ROTATE,</span><br><span class="line"></span><br><span class="line">		/**</span><br><span class="line">		 * This is the old default, and what is commonly used on iOS. Uses an</span><br><span class="line">		 * arrow image which flips depending on where the user has scrolled.</span><br><span class="line">		 */</span><br><span class="line">		FLIP;</span><br><span class="line"></span><br><span class="line">		static AnimationStyle getDefault() &#123;</span><br><span class="line">			return ROTATE;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		/**</span><br><span class="line">		 * Maps an int to a specific mode. This is needed when saving state, or</span><br><span class="line">		 * inflating the view from XML where the mode is given through a attr</span><br><span class="line">		 * int.</span><br><span class="line">		 * </span><br><span class="line">		 * @param modeInt - int to map a Mode to</span><br><span class="line">		 * @return Mode that modeInt maps to, or ROTATE by default.</span><br><span class="line">		 */</span><br><span class="line">		static AnimationStyle mapIntToValue(int modeInt) &#123;</span><br><span class="line">			switch (modeInt) &#123;</span><br><span class="line">			case 0x0:</span><br><span class="line">			default:</span><br><span class="line">				return ROTATE;</span><br><span class="line">				</span><br><span class="line">			case 0x1:</span><br><span class="line">				return FLIP;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		/**</span><br><span class="line">		 * 创建旋转Loading界面、flip Loding界面</span><br><span class="line">		 * @param context</span><br><span class="line">		 * @param mode</span><br><span class="line">		 * @param scrollDirection</span><br><span class="line">		 * @param attrs</span><br><span class="line">		 * @return</span><br><span class="line">		 */</span><br><span class="line">		LoadingLayout createLoadingLayout(Context context, Mode mode, </span><br><span class="line">				Orientation scrollDirection, TypedArray attrs) &#123;</span><br><span class="line">			</span><br><span class="line">			switch (this) &#123;</span><br><span class="line">			case ROTATE:</span><br><span class="line">			default:</span><br><span class="line">				return new RotateLoadingLayout(context, mode, scrollDirection, attrs);</span><br><span class="line">			</span><br><span class="line">			case FLIP:</span><br><span class="line">				return new FlipLoadingLayout(context, mode, scrollDirection, attrs);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	/**</span><br><span class="line">	 * 下拉刷新模式、上拉刷新模式、双向刷新模式</span><br><span class="line">	 */</span><br><span class="line">	public static enum Mode &#123;</span><br><span class="line"></span><br><span class="line">		/**</span><br><span class="line">		 * Disable all Pull-to-Refresh gesture and Refreshing handling</span><br><span class="line">		 * 关闭上/下拉刷新和正在刷新的处理</span><br><span class="line">		 */</span><br><span class="line">		DISABLED(0x0),</span><br><span class="line"></span><br><span class="line">		/**</span><br><span class="line">		 * Only allow the user to Pull from the start of the Refreshable View to</span><br><span class="line">		 * refresh. The start is either the Top or Left, depending on the</span><br><span class="line">		 * scrolling direction.</span><br><span class="line">		 * 只允许从上/左边下拉刷新</span><br><span class="line">		 */</span><br><span class="line">		PULL_FROM_START(0x1),</span><br><span class="line"></span><br><span class="line">		/**</span><br><span class="line">		 * Only allow the user to Pull from the end of the Refreshable View to</span><br><span class="line">		 * refresh. The start is either the Bottom or Right, depending on the</span><br><span class="line">		 * scrolling direction.</span><br><span class="line">		 * 只允许从下/又边上拉刷新</span><br><span class="line">		 */</span><br><span class="line">		PULL_FROM_END(0x2),</span><br><span class="line"></span><br><span class="line">		/**</span><br><span class="line">		 * Allow the user to both Pull from the start, from the end to refresh.</span><br><span class="line">		 * 允许两边上/下拉刷新</span><br><span class="line">		 */</span><br><span class="line">		BOTH(0x3),</span><br><span class="line"></span><br><span class="line">		/**</span><br><span class="line">		 * Disables Pull-to-Refresh gesture handling, but allows manually</span><br><span class="line">		 * setting the Refresh state via</span><br><span class="line">		 * &#123;@link PullToRefreshBase#setRefreshing() setRefreshing()&#125;.</span><br><span class="line">		 * 关闭上/下拉刷新手势处理，但是允许通过代码执行下/上拉刷新。</span><br><span class="line">		 */</span><br><span class="line">		MANUAL_REFRESH_ONLY(0x4);</span><br><span class="line"></span><br><span class="line">		/**</span><br><span class="line">		 * @deprecated Use &#123;@link #PULL_FROM_START&#125; from now on.</span><br><span class="line">		 */</span><br><span class="line">		public static Mode PULL_DOWN_TO_REFRESH = Mode.PULL_FROM_START;</span><br><span class="line"></span><br><span class="line">		/**</span><br><span class="line">		 * @deprecated Use &#123;@link #PULL_FROM_END&#125; from now on.</span><br><span class="line">		 */</span><br><span class="line">		public static Mode PULL_UP_TO_REFRESH = Mode.PULL_FROM_END;</span><br><span class="line"></span><br><span class="line">		/**</span><br><span class="line">		 * Maps an int to a specific mode. This is needed when saving state, or</span><br><span class="line">		 * inflating the view from XML where the mode is given through a attr</span><br><span class="line">		 * int.</span><br><span class="line">		 * </span><br><span class="line">		 * @param modeInt - int to map a Mode to</span><br><span class="line">		 * @return Mode that modeInt maps to, or PULL_FROM_START by default.</span><br><span class="line">		 */</span><br><span class="line">		static Mode mapIntToValue(final int modeInt) &#123;</span><br><span class="line">			for (Mode value : Mode.values()) &#123;</span><br><span class="line">				if (modeInt == value.getIntValue()) &#123;</span><br><span class="line">					return value;</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line"></span><br><span class="line">			// If not, return default</span><br><span class="line">			return getDefault();</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		static Mode getDefault() &#123;</span><br><span class="line">			return PULL_FROM_START;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		private int mIntValue;</span><br><span class="line"></span><br><span class="line">		// The modeInt values need to match those from attrs.xml</span><br><span class="line">		Mode(int modeInt) &#123;</span><br><span class="line">			mIntValue = modeInt;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		/**</span><br><span class="line">		 * @return true if the mode permits Pull-to-Refresh</span><br><span class="line">		 */</span><br><span class="line">		boolean permitsPullToRefresh() &#123;</span><br><span class="line">			return !(this == DISABLED || this == MANUAL_REFRESH_ONLY);</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		/**</span><br><span class="line">		 * @return true if this mode wants the Loading Layout Header to be shown</span><br><span class="line">		 * 返回是否允许下拉刷新</span><br><span class="line">		 */</span><br><span class="line">		public boolean showHeaderLoadingLayout() &#123;</span><br><span class="line">			return this == PULL_FROM_START || this == BOTH;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		/**</span><br><span class="line">		 * @return true if this mode wants the Loading Layout Footer to be shown</span><br><span class="line">		 * 返回是否允许上拉刷新</span><br><span class="line">		 */</span><br><span class="line">		public boolean showFooterLoadingLayout() &#123;</span><br><span class="line">			return this == PULL_FROM_END || this == BOTH || this == MANUAL_REFRESH_ONLY;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		int getIntValue() &#123;</span><br><span class="line">			return mIntValue;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	// ===========================================================</span><br><span class="line">	// Inner, Anonymous Classes, and Enumerations</span><br><span class="line">	// ===========================================================</span><br><span class="line"></span><br><span class="line">	/**</span><br><span class="line">	 * Simple Listener that allows you to be notified when the user has scrolled</span><br><span class="line">	 * to the end of the AdapterView. See (</span><br><span class="line">	 * &#123;@link PullToRefreshAdapterViewBase#setOnLastItemVisibleListener&#125;.</span><br><span class="line">	 * </span><br><span class="line">	 * @author Chris Banes</span><br><span class="line">	 */</span><br><span class="line">	public static interface OnLastItemVisibleListener &#123;</span><br><span class="line"></span><br><span class="line">		/**</span><br><span class="line">		 * Called when the user has scrolled to the end of the list</span><br><span class="line">		 */</span><br><span class="line">		public void onLastItemVisible();</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	/**</span><br><span class="line">	 * Listener that allows you to be notified when the user has started or</span><br><span class="line">	 * finished a touch event. Useful when you want to append extra UI events</span><br><span class="line">	 * (such as sounds). See (</span><br><span class="line">	 * &#123;@link PullToRefreshAdapterViewBase#setOnPullEventListener&#125;.</span><br><span class="line">	 * </span><br><span class="line">	 * @author Chris Banes</span><br><span class="line">	 */</span><br><span class="line">	public static interface OnPullEventListener&lt;V extends View&gt; &#123;</span><br><span class="line"></span><br><span class="line">		/**</span><br><span class="line">		 * Called when the internal state has been changed, usually by the user</span><br><span class="line">		 * pulling.</span><br><span class="line">		 * </span><br><span class="line">		 * @param refreshView - View which has had it&apos;s state change.</span><br><span class="line">		 * @param state - The new state of View.</span><br><span class="line">		 * @param direction - One of &#123;@link Mode#PULL_FROM_START&#125; or</span><br><span class="line">		 *            &#123;@link Mode#PULL_FROM_END&#125; depending on which direction</span><br><span class="line">		 *            the user is pulling. Only useful when &lt;var&gt;state&lt;/var&gt; is</span><br><span class="line">		 *            &#123;@link State#PULL_TO_REFRESH&#125; or</span><br><span class="line">		 *            &#123;@link State#RELEASE_TO_REFRESH&#125;.</span><br><span class="line">		 */</span><br><span class="line">		public void onPullEvent(final PullToRefreshBase&lt;V&gt; refreshView, State state, Mode direction);</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	/**</span><br><span class="line">	 * Simple Listener to listen for any callbacks to Refresh.</span><br><span class="line">	 * </span><br><span class="line">	 * @author Chris Banes</span><br><span class="line">	 */</span><br><span class="line">	public static interface OnRefreshListener&lt;V extends View&gt; &#123;</span><br><span class="line"></span><br><span class="line">		/**</span><br><span class="line">		 * onRefresh will be called for both a Pull from start, and Pull from</span><br><span class="line">		 * end</span><br><span class="line">		 */</span><br><span class="line">		public void onRefresh(final PullToRefreshBase&lt;V&gt; refreshView);</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	/**</span><br><span class="line">	 * An advanced version of the Listener to listen for callbacks to Refresh.</span><br><span class="line">	 * This listener is different as it allows you to differentiate between Pull</span><br><span class="line">	 * Ups, and Pull Downs.</span><br><span class="line">	 * </span><br><span class="line">	 * @author Chris Banes</span><br><span class="line">	 */</span><br><span class="line">	public static interface OnRefreshListener2&lt;V extends View&gt; &#123;</span><br><span class="line">		// TODO These methods need renaming to START/END rather than DOWN/UP</span><br><span class="line"></span><br><span class="line">		/**</span><br><span class="line">		 * onPullDownToRefresh will be called only when the user has Pulled from</span><br><span class="line">		 * the start, and released.</span><br><span class="line">		 */</span><br><span class="line">		public void onPullDownToRefresh(final PullToRefreshBase&lt;V&gt; refreshView);</span><br><span class="line"></span><br><span class="line">		/**</span><br><span class="line">		 * onPullUpToRefresh will be called only when the user has Pulled from</span><br><span class="line">		 * the end, and released.</span><br><span class="line">		 */</span><br><span class="line">		public void onPullUpToRefresh(final PullToRefreshBase&lt;V&gt; refreshView);</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	public static enum Orientation &#123;</span><br><span class="line">		VERTICAL, HORIZONTAL;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	/**</span><br><span class="line">	 * 状态：重置状态、拖动手势状态、释放拖动手势状态、正在刷新模式等</span><br><span class="line">	 */</span><br><span class="line">	public static enum State &#123;</span><br><span class="line"></span><br><span class="line">		/**</span><br><span class="line">		 * When the UI is in a state which means that user is not interacting</span><br><span class="line">		 * with the Pull-to-Refresh function.</span><br><span class="line">		 * 用户还没有和PullToRefresh交互</span><br><span class="line">		 */</span><br><span class="line">		RESET(0x0),</span><br><span class="line"></span><br><span class="line">		/**</span><br><span class="line">		 * When the UI is being pulled by the user, but has not been pulled far</span><br><span class="line">		 * enough so that it refreshes when released.</span><br><span class="line">		 * 用户正在拖动刷新操作</span><br><span class="line">		 */</span><br><span class="line">		PULL_TO_REFRESH(0x1),</span><br><span class="line"></span><br><span class="line">		/**</span><br><span class="line">		 * When the UI is being pulled by the user, and &lt;strong&gt;has&lt;/strong&gt;</span><br><span class="line">		 * been pulled far enough so that it will refresh when released.</span><br><span class="line">		 * 用户拖动释放后</span><br><span class="line">		 */</span><br><span class="line">		RELEASE_TO_REFRESH(0x2),</span><br><span class="line"></span><br><span class="line">		/**</span><br><span class="line">		 * When the UI is currently refreshing, caused by a pull gesture.</span><br><span class="line">		 * 正在刷新</span><br><span class="line">		 */</span><br><span class="line">		REFRESHING(0x8),</span><br><span class="line"></span><br><span class="line">		/**</span><br><span class="line">		 * When the UI is currently refreshing, caused by a call to</span><br><span class="line">		 * &#123;@link PullToRefreshBase#setRefreshing() setRefreshing()&#125;.</span><br><span class="line">		 * 代码中指定正在刷新中...</span><br><span class="line">		 */</span><br><span class="line">		MANUAL_REFRESHING(0x9),</span><br><span class="line"></span><br><span class="line">		/**</span><br><span class="line">		 * When the UI is currently overscrolling, caused by a fling on the</span><br><span class="line">		 * Refreshable View.</span><br><span class="line">		 * 正在弹簧滚动中...</span><br><span class="line">		 */</span><br><span class="line">		OVERSCROLLING(0x10);</span><br><span class="line"></span><br><span class="line">		/**</span><br><span class="line">		 * Maps an int to a specific state. This is needed when saving state.</span><br><span class="line">		 * </span><br><span class="line">		 * @param stateInt - int to map a State to</span><br><span class="line">		 * @return State that stateInt maps to</span><br><span class="line">		 */</span><br><span class="line">		static State mapIntToValue(final int stateInt) &#123;</span><br><span class="line">			for (State value : State.values()) &#123;</span><br><span class="line">				if (stateInt == value.getIntValue()) &#123;</span><br><span class="line">					return value;</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line"></span><br><span class="line">			// If not, return default</span><br><span class="line">			return RESET;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		private int mIntValue;</span><br><span class="line"></span><br><span class="line">		State(int intValue) &#123;</span><br><span class="line">			mIntValue = intValue;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		int getIntValue() &#123;</span><br><span class="line">			return mIntValue;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	/**</span><br><span class="line">	 * 在独立线程中overscroll头部或尾部</span><br><span class="line">	 */</span><br><span class="line">	final class SmoothScrollRunnable implements Runnable &#123;</span><br><span class="line">		private final Interpolator mInterpolator;</span><br><span class="line">		private final int mScrollToY;</span><br><span class="line">		private final int mScrollFromY;</span><br><span class="line">		private final long mDuration;</span><br><span class="line">		private OnSmoothScrollFinishedListener mListener;</span><br><span class="line"></span><br><span class="line">		private boolean mContinueRunning = true;</span><br><span class="line">		private long mStartTime = -1;</span><br><span class="line">		private int mCurrentY = -1;</span><br><span class="line"></span><br><span class="line">		public SmoothScrollRunnable(int fromY, int toY, long duration, </span><br><span class="line">				OnSmoothScrollFinishedListener listener) &#123;</span><br><span class="line">			</span><br><span class="line">			mScrollFromY = fromY;</span><br><span class="line">			mScrollToY = toY;</span><br><span class="line">			mInterpolator = mScrollAnimationInterpolator;</span><br><span class="line">			mDuration = duration;</span><br><span class="line">			mListener = listener;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		@Override</span><br><span class="line">		public void run() &#123;</span><br><span class="line"></span><br><span class="line">			/**</span><br><span class="line">			 * Only set mStartTime if this is the first time we&apos;re starting,</span><br><span class="line">			 * else actually calculate the Y delta</span><br><span class="line">			 */</span><br><span class="line">			if (mStartTime == -1) &#123;</span><br><span class="line">				mStartTime = System.currentTimeMillis();</span><br><span class="line">			&#125; else &#123;</span><br><span class="line"></span><br><span class="line">				/**</span><br><span class="line">				 * We do do all calculations in long to reduce software float</span><br><span class="line">				 * calculations. We use 1000 as it gives us good accuracy and</span><br><span class="line">				 * small rounding errors</span><br><span class="line">				 */</span><br><span class="line">				long normalizedTime = (1000 * (System.currentTimeMillis() - mStartTime)) / mDuration;</span><br><span class="line">				normalizedTime = Math.max(Math.min(normalizedTime, 1000), 0);</span><br><span class="line"></span><br><span class="line">				final int deltaY = Math.round((mScrollFromY - mScrollToY)</span><br><span class="line">						* mInterpolator.getInterpolation(normalizedTime / 1000f));</span><br><span class="line">				</span><br><span class="line">				mCurrentY = mScrollFromY - deltaY;</span><br><span class="line">				setHeaderScroll(mCurrentY);</span><br><span class="line">			&#125;</span><br><span class="line"></span><br><span class="line">			// If we&apos;re not at the target Y, keep going...</span><br><span class="line">			if (mContinueRunning &amp;&amp; mScrollToY != mCurrentY) &#123;</span><br><span class="line">				ViewCompat.postOnAnimation(PullToRefreshBase.this, this);</span><br><span class="line">			&#125; else &#123;</span><br><span class="line">				if (null != mListener) &#123;</span><br><span class="line">					mListener.onSmoothScrollFinished();</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		public void stop() &#123;</span><br><span class="line">			mContinueRunning = false;</span><br><span class="line">			removeCallbacks(this);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	static interface OnSmoothScrollFinishedListener &#123;</span><br><span class="line">		void onSmoothScrollFinished();</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>####核心类LoadingLayout代码分析：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br></pre></td><td class="code"><pre><span class="line">/*******************************************************************************</span><br><span class="line"> * Copyright 2011, 2012 Chris Banes.</span><br><span class="line"> *</span><br><span class="line"> * Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);</span><br><span class="line"> * you may not use this file except in compliance with the License.</span><br><span class="line"> * You may obtain a copy of the License at</span><br><span class="line"> *</span><br><span class="line"> * http://www.apache.org/licenses/LICENSE-2.0</span><br><span class="line"> *</span><br><span class="line"> * Unless required by applicable law or agreed to in writing, software</span><br><span class="line"> * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,</span><br><span class="line"> * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.</span><br><span class="line"> * See the License for the specific language governing permissions and</span><br><span class="line"> * limitations under the License.</span><br><span class="line"> *******************************************************************************/</span><br><span class="line">package com.handmark.pulltorefresh.library.internal;</span><br><span class="line"></span><br><span class="line">import android.annotation.SuppressLint;</span><br><span class="line">import android.content.Context;</span><br><span class="line">import android.content.res.ColorStateList;</span><br><span class="line">import android.content.res.TypedArray;</span><br><span class="line">import android.graphics.Typeface;</span><br><span class="line">import android.graphics.drawable.AnimationDrawable;</span><br><span class="line">import android.graphics.drawable.Drawable;</span><br><span class="line">import android.text.TextUtils;</span><br><span class="line">import android.util.TypedValue;</span><br><span class="line">import android.view.Gravity;</span><br><span class="line">import android.view.LayoutInflater;</span><br><span class="line">import android.view.View;</span><br><span class="line">import android.view.ViewGroup;</span><br><span class="line">import android.view.animation.Interpolator;</span><br><span class="line">import android.view.animation.LinearInterpolator;</span><br><span class="line">import android.widget.FrameLayout;</span><br><span class="line">import android.widget.ImageView;</span><br><span class="line">import android.widget.ProgressBar;</span><br><span class="line">import android.widget.TextView;</span><br><span class="line"></span><br><span class="line">import com.handmark.pulltorefresh.library.ILoadingLayout;</span><br><span class="line">import com.handmark.pulltorefresh.library.PullToRefreshBase.Mode;</span><br><span class="line">import com.handmark.pulltorefresh.library.PullToRefreshBase.Orientation;</span><br><span class="line">import com.handmark.pulltorefresh.library.R;</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> * 自定义Loading控件，这个是用户自定义Loading控件的基类，用户自定义的Loading控件</span><br><span class="line"> * 必须继承这个类，比如：FlipLoadingLayout、RotateLoadingLayout。这个类完成了Loading控件</span><br><span class="line"> * 的界面框架，其子类中还可以指定图片动画方式等。</span><br><span class="line"> */</span><br><span class="line">@SuppressLint(&quot;ViewConstructor&quot;)</span><br><span class="line">public abstract class LoadingLayout extends FrameLayout implements ILoadingLayout &#123;</span><br><span class="line">	static final String LOG_TAG = &quot;PullToRefresh-LoadingLayout&quot;;</span><br><span class="line"></span><br><span class="line">	static final Interpolator ANIMATION_INTERPOLATOR = new LinearInterpolator();</span><br><span class="line">	private FrameLayout mInnerLayout; // 该界面布局包含的布局器</span><br><span class="line"></span><br><span class="line">	protected final ImageView mHeaderImage; // 左边用于Rotate/Flip动画的图片</span><br><span class="line">	protected final ProgressBar mHeaderProgress; // 左边用于动画的圆形进度条</span><br><span class="line"></span><br><span class="line">	private boolean mUseIntrinsicAnimation;	// 使用内置动画的标志</span><br><span class="line"></span><br><span class="line">	private final TextView mHeaderText; // 右边主标题</span><br><span class="line">	private final TextView mSubHeaderText; // 右边副标题</span><br><span class="line"></span><br><span class="line">	protected final Mode mMode; // 下拉/上拉刷新模式</span><br><span class="line">	protected final Orientation mScrollDirection; // Pull方向</span><br><span class="line"></span><br><span class="line">	private CharSequence mPullLabel;		// 拖动手势时上拉/下拉刷新文本</span><br><span class="line">	private CharSequence mRefreshingLabel;	// 正在刷新的文本</span><br><span class="line">	private CharSequence mReleaseLabel;		// 手势上/下拉释放后的文本</span><br><span class="line"></span><br><span class="line">	/**</span><br><span class="line">	 * 构造函数：加载Loading header或footer，并根据xml属性设置Loading header或footer，</span><br><span class="line">	 * 最后根据客户端代码中指定的Loading header或footer样式(通过ILoadingLayout)，再次</span><br><span class="line">	 * 设置Loading View。</span><br><span class="line">	 * </span><br><span class="line">	 * @param context</span><br><span class="line">	 * @param mode</span><br><span class="line">	 * @param scrollDirection 滚动方向</span><br><span class="line">	 * @param attrs 从PullToRefresh View传递过来的xml属性集合</span><br><span class="line">	 */</span><br><span class="line">	public LoadingLayout(Context context, final Mode mode, </span><br><span class="line">			final Orientation scrollDirection, TypedArray attrs) &#123;</span><br><span class="line">		</span><br><span class="line">		super(context);</span><br><span class="line">		</span><br><span class="line">		mMode = mode;</span><br><span class="line">		mScrollDirection = scrollDirection;</span><br><span class="line"></span><br><span class="line">		switch (scrollDirection) &#123;</span><br><span class="line">		case HORIZONTAL:</span><br><span class="line">			LayoutInflater.from(context).inflate(R.layout.pull_to_refresh_header_horizontal, this);</span><br><span class="line">			break;</span><br><span class="line">			</span><br><span class="line">		case VERTICAL:</span><br><span class="line">		default: // 从layou的xml中获取自定义界面，并加入到当前界面中(这个this参数就是layou的父类)</span><br><span class="line">			LayoutInflater.from(context).inflate(R.layout.pull_to_refresh_header_vertical, this);</span><br><span class="line">			break;</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">		mInnerLayout = (FrameLayout) findViewById(R.id.fl_inner);</span><br><span class="line">		mHeaderText = (TextView) mInnerLayout.findViewById(R.id.pull_to_refresh_text);</span><br><span class="line">		mHeaderProgress = (ProgressBar) mInnerLayout.findViewById(R.id.pull_to_refresh_progress);</span><br><span class="line">		mSubHeaderText = (TextView) mInnerLayout.findViewById(R.id.pull_to_refresh_sub_text);</span><br><span class="line">		mHeaderImage = (ImageView) mInnerLayout.findViewById(R.id.pull_to_refresh_image);</span><br><span class="line">		</span><br><span class="line">		FrameLayout.LayoutParams layoutParams = (FrameLayout.LayoutParams) mInnerLayout.getLayoutParams();</span><br><span class="line"></span><br><span class="line">		switch (mode) &#123;</span><br><span class="line">		case PULL_FROM_END:	// 上拉</span><br><span class="line">			layoutParams.gravity = scrollDirection == Orientation.VERTICAL ? Gravity.TOP : Gravity.LEFT;</span><br><span class="line">			</span><br><span class="line">			// Load in labels</span><br><span class="line">			mPullLabel = context.getString(R.string.pull_to_refresh_from_bottom_pull_label);</span><br><span class="line">			mRefreshingLabel = context.getString(R.string.pull_to_refresh_from_bottom_refreshing_label);</span><br><span class="line">			mReleaseLabel = context.getString(R.string.pull_to_refresh_from_bottom_release_label);</span><br><span class="line">			break;</span><br><span class="line"></span><br><span class="line">		case PULL_FROM_START:	// 下拉</span><br><span class="line">		default:</span><br><span class="line">			layoutParams.gravity = scrollDirection == Orientation.VERTICAL ? Gravity.BOTTOM : Gravity.RIGHT;</span><br><span class="line"></span><br><span class="line">			// Load in labels</span><br><span class="line">			mPullLabel = context.getString(R.string.pull_to_refresh_pull_label);</span><br><span class="line">			mRefreshingLabel = context.getString(R.string.pull_to_refresh_refreshing_label);</span><br><span class="line">			mReleaseLabel = context.getString(R.string.pull_to_refresh_release_label);</span><br><span class="line">			break;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		// 设置属性</span><br><span class="line">		if (attrs.hasValue(R.styleable.PullToRefresh_ptrHeaderBackground)) &#123;</span><br><span class="line">			Drawable background = attrs.getDrawable(R.styleable.PullToRefresh_ptrHeaderBackground);</span><br><span class="line">			if (null != background) &#123;</span><br><span class="line">				ViewCompat.setBackground(this, background);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">		if (attrs.hasValue(R.styleable.PullToRefresh_ptrHeaderTextAppearance)) &#123;</span><br><span class="line">			TypedValue styleID = new TypedValue();</span><br><span class="line">			attrs.getValue(R.styleable.PullToRefresh_ptrHeaderTextAppearance, styleID);</span><br><span class="line">			setTextAppearance(styleID.data);</span><br><span class="line">		&#125;</span><br><span class="line">		if (attrs.hasValue(R.styleable.PullToRefresh_ptrSubHeaderTextAppearance)) &#123;</span><br><span class="line">			TypedValue styleID = new TypedValue();</span><br><span class="line">			attrs.getValue(R.styleable.PullToRefresh_ptrSubHeaderTextAppearance, styleID);</span><br><span class="line">			setSubTextAppearance(styleID.data);</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">		// Text Color attrs need to be set after TextAppearance attrs</span><br><span class="line">		if (attrs.hasValue(R.styleable.PullToRefresh_ptrHeaderTextColor)) &#123;</span><br><span class="line">			ColorStateList colors = attrs.getColorStateList(R.styleable.PullToRefresh_ptrHeaderTextColor);</span><br><span class="line">			if (null != colors) &#123;</span><br><span class="line">				setTextColor(colors);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		if (attrs.hasValue(R.styleable.PullToRefresh_ptrHeaderSubTextColor)) &#123;</span><br><span class="line">			ColorStateList colors = attrs.getColorStateList(R.styleable.PullToRefresh_ptrHeaderSubTextColor);</span><br><span class="line">			if (null != colors) &#123;</span><br><span class="line">				setSubTextColor(colors);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">		// Try and get defined drawable from Attrs</span><br><span class="line">		Drawable imageDrawable = null;</span><br><span class="line">		if (attrs.hasValue(R.styleable.PullToRefresh_ptrDrawable)) &#123;</span><br><span class="line">			imageDrawable = attrs.getDrawable(R.styleable.PullToRefresh_ptrDrawable);</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">		// Check Specific Drawable from Attrs, these overrite the generic</span><br><span class="line">		// drawable attr above</span><br><span class="line">		switch (mode) &#123;</span><br><span class="line">		case PULL_FROM_START:</span><br><span class="line">		default:</span><br><span class="line">			if (attrs.hasValue(R.styleable.PullToRefresh_ptrDrawableStart)) &#123;</span><br><span class="line">				imageDrawable = attrs.getDrawable(R.styleable.PullToRefresh_ptrDrawableStart);</span><br><span class="line">			&#125; else if (attrs.hasValue(R.styleable.PullToRefresh_ptrDrawableTop)) &#123;</span><br><span class="line">				Utils.warnDeprecation(&quot;ptrDrawableTop&quot;, &quot;ptrDrawableStart&quot;);</span><br><span class="line">				imageDrawable = attrs.getDrawable(R.styleable.PullToRefresh_ptrDrawableTop);</span><br><span class="line">			&#125;</span><br><span class="line">			break;</span><br><span class="line"></span><br><span class="line">		case PULL_FROM_END:</span><br><span class="line">			if (attrs.hasValue(R.styleable.PullToRefresh_ptrDrawableEnd)) &#123;</span><br><span class="line">				imageDrawable = attrs.getDrawable(R.styleable.PullToRefresh_ptrDrawableEnd);</span><br><span class="line">			&#125; else if (attrs.hasValue(R.styleable.PullToRefresh_ptrDrawableBottom)) &#123;</span><br><span class="line">				Utils.warnDeprecation(&quot;ptrDrawableBottom&quot;, &quot;ptrDrawableEnd&quot;);</span><br><span class="line">				imageDrawable = attrs.getDrawable(R.styleable.PullToRefresh_ptrDrawableBottom);</span><br><span class="line">			&#125;</span><br><span class="line">			break;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		// If we don&apos;t have a user defined drawable, load the default</span><br><span class="line">		if (null == imageDrawable) &#123;</span><br><span class="line">			imageDrawable = context.getResources().getDrawable(getDefaultDrawableResId());</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		// Set Drawable, and save width/height</span><br><span class="line">		setLoadingDrawable(imageDrawable);</span><br><span class="line"></span><br><span class="line">		reset();</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	public final void setHeight(int height) &#123;</span><br><span class="line">		ViewGroup.LayoutParams lp = (ViewGroup.LayoutParams) getLayoutParams();</span><br><span class="line">		lp.height = height;</span><br><span class="line">		requestLayout();</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	public final void setWidth(int width) &#123;</span><br><span class="line">		ViewGroup.LayoutParams lp = (ViewGroup.LayoutParams) getLayoutParams();</span><br><span class="line">		lp.width = width;</span><br><span class="line">		requestLayout();</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	/**</span><br><span class="line">	 * 获得Loading View的宽度或高度</span><br><span class="line">	 * @return</span><br><span class="line">	 */</span><br><span class="line">	public final int getContentSize() &#123;</span><br><span class="line">		switch (mScrollDirection) &#123;</span><br><span class="line">		case HORIZONTAL:</span><br><span class="line">			return mInnerLayout.getWidth();</span><br><span class="line">			</span><br><span class="line">		case VERTICAL:</span><br><span class="line">		default:</span><br><span class="line">			return mInnerLayout.getHeight();</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	/**</span><br><span class="line">	 * 隐藏Loading View</span><br><span class="line">	 */</span><br><span class="line">	public final void hideAllViews() &#123;</span><br><span class="line">		if (View.VISIBLE == mHeaderText.getVisibility()) &#123;</span><br><span class="line">			mHeaderText.setVisibility(View.INVISIBLE);</span><br><span class="line">		&#125;</span><br><span class="line">		if (View.VISIBLE == mHeaderProgress.getVisibility()) &#123;</span><br><span class="line">			mHeaderProgress.setVisibility(View.INVISIBLE);</span><br><span class="line">		&#125;</span><br><span class="line">		if (View.VISIBLE == mHeaderImage.getVisibility()) &#123;</span><br><span class="line">			mHeaderImage.setVisibility(View.INVISIBLE);</span><br><span class="line">		&#125;</span><br><span class="line">		if (View.VISIBLE == mSubHeaderText.getVisibility()) &#123;</span><br><span class="line">			mSubHeaderText.setVisibility(View.INVISIBLE);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	/**</span><br><span class="line">	 * 在手势下/上拉时候回调</span><br><span class="line">	 * @param scaleOfLayout</span><br><span class="line">	 */</span><br><span class="line">	public final void onPull(float scaleOfLayout) &#123;</span><br><span class="line">		if (!mUseIntrinsicAnimation) &#123;</span><br><span class="line">			onPullImpl(scaleOfLayout);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	/**</span><br><span class="line">	 * 下/上拉手势正在执行时的：刷新后的回调</span><br><span class="line">	 */</span><br><span class="line">	public final void pullToRefresh() &#123;</span><br><span class="line">		if (null != mHeaderText) &#123;</span><br><span class="line">			mHeaderText.setText(mPullLabel);</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		// Now call the callback</span><br><span class="line">		pullToRefreshImpl();</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	/**</span><br><span class="line">	 * 正在下/上拉刷新中...</span><br><span class="line">	 */</span><br><span class="line">	public final void refreshing() &#123;</span><br><span class="line">		if (null != mHeaderText) &#123;</span><br><span class="line">			mHeaderText.setText(mRefreshingLabel);</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		if (mUseIntrinsicAnimation) &#123;</span><br><span class="line">			((AnimationDrawable) mHeaderImage.getDrawable()).start();</span><br><span class="line">		&#125; else &#123; // Now call the callback</span><br><span class="line">			refreshingImpl();</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		if (null != mSubHeaderText) &#123;</span><br><span class="line">			mSubHeaderText.setVisibility(View.GONE);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	public final void releaseToRefresh() &#123;</span><br><span class="line">		if (null != mHeaderText) &#123;</span><br><span class="line">			mHeaderText.setText(mReleaseLabel);</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		// Now call the callback</span><br><span class="line">		releaseToRefreshImpl();</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	/**</span><br><span class="line">	 * 重新设置Loading View</span><br><span class="line">	 */</span><br><span class="line">	public final void reset() &#123;</span><br><span class="line">		if (null != mHeaderText) &#123;</span><br><span class="line">			mHeaderText.setText(mPullLabel);</span><br><span class="line">		&#125;</span><br><span class="line">		mHeaderImage.setVisibility(View.VISIBLE);</span><br><span class="line"></span><br><span class="line">		if (mUseIntrinsicAnimation) &#123;</span><br><span class="line">			((AnimationDrawable) mHeaderImage.getDrawable()).stop();</span><br><span class="line">		&#125; else &#123; // Now call the callback</span><br><span class="line">			resetImpl();</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		if (null != mSubHeaderText) &#123;</span><br><span class="line">			if (TextUtils.isEmpty(mSubHeaderText.getText())) &#123;</span><br><span class="line">				mSubHeaderText.setVisibility(View.GONE);</span><br><span class="line">			&#125; else &#123;</span><br><span class="line">				mSubHeaderText.setVisibility(View.VISIBLE);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	/**</span><br><span class="line">	 * 设置最近更新文本</span><br><span class="line">	 */</span><br><span class="line">	@Override</span><br><span class="line">	public void setLastUpdatedLabel(CharSequence label) &#123;</span><br><span class="line">		setSubHeaderText(label);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	/**</span><br><span class="line">	 * 设置Loading图片</span><br><span class="line">	 */</span><br><span class="line">	@Override</span><br><span class="line">	public final void setLoadingDrawable(Drawable imageDrawable) &#123;</span><br><span class="line">		mHeaderImage.setImageDrawable(imageDrawable);	// Set Drawable</span><br><span class="line">		mUseIntrinsicAnimation = (imageDrawable instanceof AnimationDrawable);</span><br><span class="line"></span><br><span class="line">		// Now call the callback</span><br><span class="line">		onLoadingDrawableSet(imageDrawable);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	/**</span><br><span class="line">	 * 设置下/上拉时候的文本</span><br><span class="line">	 */</span><br><span class="line">	@Override</span><br><span class="line">	public void setPullLabel(CharSequence pullLabel) &#123;</span><br><span class="line">		mPullLabel = pullLabel;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	/**</span><br><span class="line">	 * 设置正在刷新时的文本</span><br><span class="line">	 */</span><br><span class="line">	@Override</span><br><span class="line">	public void setRefreshingLabel(CharSequence refreshingLabel) &#123;</span><br><span class="line">		mRefreshingLabel = refreshingLabel;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	/**</span><br><span class="line">	 * 设置正在释放刷新时的文本</span><br><span class="line">	 */</span><br><span class="line">	@Override</span><br><span class="line">	public void setReleaseLabel(CharSequence releaseLabel) &#123;</span><br><span class="line">		mReleaseLabel = releaseLabel;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	/**</span><br><span class="line">	 * 设置文本字体</span><br><span class="line">	 */</span><br><span class="line">	@Override</span><br><span class="line">	public void setTextTypeface(Typeface tf) &#123;</span><br><span class="line">		mHeaderText.setTypeface(tf);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	public final void showInvisibleViews() &#123;</span><br><span class="line">		if (View.INVISIBLE == mHeaderText.getVisibility()) &#123;</span><br><span class="line">			mHeaderText.setVisibility(View.VISIBLE);</span><br><span class="line">		&#125;</span><br><span class="line">		if (View.INVISIBLE == mHeaderProgress.getVisibility()) &#123;</span><br><span class="line">			mHeaderProgress.setVisibility(View.VISIBLE);</span><br><span class="line">		&#125;</span><br><span class="line">		if (View.INVISIBLE == mHeaderImage.getVisibility()) &#123;</span><br><span class="line">			mHeaderImage.setVisibility(View.VISIBLE);</span><br><span class="line">		&#125;</span><br><span class="line">		if (View.INVISIBLE == mSubHeaderText.getVisibility()) &#123;</span><br><span class="line">			mSubHeaderText.setVisibility(View.VISIBLE);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	/**</span><br><span class="line">	 * Callbacks for derivative Layouts</span><br><span class="line">	 */</span><br><span class="line">	// If we don&apos;t have a user defined drawable, load the default</span><br><span class="line">	protected abstract int getDefaultDrawableResId();</span><br><span class="line">	// 设置Loading图片时候的回调</span><br><span class="line">	protected abstract void onLoadingDrawableSet(Drawable imageDrawable);</span><br><span class="line">	// 在手势下/上拉时候回调</span><br><span class="line">	protected abstract void onPullImpl(float scaleOfLayout);</span><br><span class="line">	// 下/上拉手势正在执行时的：刷新后的回调</span><br><span class="line">	protected abstract void pullToRefreshImpl();</span><br><span class="line">	// 正在下/上拉刷新中...的回调</span><br><span class="line">	protected abstract void refreshingImpl();</span><br><span class="line">	// 手势释放后的回调</span><br><span class="line">	protected abstract void releaseToRefreshImpl();</span><br><span class="line">	// Loading View重置后的回调</span><br><span class="line">	protected abstract void resetImpl();</span><br><span class="line"></span><br><span class="line">	/*</span><br><span class="line">	 * 设置头部副标题</span><br><span class="line">	 */</span><br><span class="line">	private void setSubHeaderText(CharSequence label) &#123;</span><br><span class="line">		if (null != mSubHeaderText) &#123;</span><br><span class="line">			if (TextUtils.isEmpty(label)) &#123;</span><br><span class="line">				mSubHeaderText.setVisibility(View.GONE);</span><br><span class="line">			&#125; else &#123;</span><br><span class="line">				mSubHeaderText.setText(label);</span><br><span class="line"></span><br><span class="line">				// Only set it to Visible if we&apos;re GONE, otherwise VISIBLE will</span><br><span class="line">				// be set soon</span><br><span class="line">				if (View.GONE == mSubHeaderText.getVisibility()) &#123;</span><br><span class="line">					mSubHeaderText.setVisibility(View.VISIBLE);</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	private void setSubTextAppearance(int value) &#123;</span><br><span class="line">		if (null != mSubHeaderText) &#123;</span><br><span class="line">			mSubHeaderText.setTextAppearance(getContext(), value);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	private void setSubTextColor(ColorStateList color) &#123;</span><br><span class="line">		if (null != mSubHeaderText) &#123;</span><br><span class="line">			mSubHeaderText.setTextColor(color);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	private void setTextAppearance(int value) &#123;</span><br><span class="line">		if (null != mHeaderText) &#123;</span><br><span class="line">			mHeaderText.setTextAppearance(getContext(), value);</span><br><span class="line">		&#125;</span><br><span class="line">		if (null != mSubHeaderText) &#123;</span><br><span class="line">			mSubHeaderText.setTextAppearance(getContext(), value);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	private void setTextColor(ColorStateList color) &#123;</span><br><span class="line">		if (null != mHeaderText) &#123;</span><br><span class="line">			mHeaderText.setTextColor(color);</span><br><span class="line">		&#125;</span><br><span class="line">		if (null != mSubHeaderText) &#123;</span><br><span class="line">			mSubHeaderText.setTextColor(color);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://makohill.github.io/home/thrusday/workspace/makohill.github.io/public/2016/04/20/Android/开源项目：Android-PullToRefresh源码分析/" data-id="cin8zn6n6001yjtxurvnu2l93" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  


  <nav id="page-nav">
    <a class="extend prev" rel="prev" href="/home/thrusday/workspace/makohill.github.io/public/">&laquo; __('prev')</a><a class="page-number" href="/home/thrusday/workspace/makohill.github.io/public/">1</a><span class="page-number current">2</span><a class="page-number" href="/home/thrusday/workspace/makohill.github.io/public/page/3/">3</a><a class="page-number" href="/home/thrusday/workspace/makohill.github.io/public/page/4/">4</a><span class="space">&hellip;</span><a class="page-number" href="/home/thrusday/workspace/makohill.github.io/public/page/7/">7</a><a class="extend next" rel="next" href="/home/thrusday/workspace/makohill.github.io/public/page/3/">__('next') &raquo;</a>
  </nav>
</section>
        
          <aside id="sidebar">
  
    

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/home/thrusday/workspace/makohill.github.io/public/tags/Geocaching/">Geocaching</a></li><li class="tag-list-item"><a class="tag-list-link" href="/home/thrusday/workspace/makohill.github.io/public/tags/iOS/">iOS</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/home/thrusday/workspace/makohill.github.io/public/tags/Geocaching/" style="font-size: 20px;">Geocaching</a> <a href="/home/thrusday/workspace/makohill.github.io/public/tags/iOS/" style="font-size: 10px;">iOS</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/home/thrusday/workspace/makohill.github.io/public/archives/2016/04/">April 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/home/thrusday/workspace/makohill.github.io/public/archives/2015/12/">December 2015</a></li><li class="archive-list-item"><a class="archive-list-link" href="/home/thrusday/workspace/makohill.github.io/public/archives/2015/07/">July 2015</a></li><li class="archive-list-item"><a class="archive-list-link" href="/home/thrusday/workspace/makohill.github.io/public/archives/2015/06/">June 2015</a></li><li class="archive-list-item"><a class="archive-list-link" href="/home/thrusday/workspace/makohill.github.io/public/archives/2015/04/">April 2015</a></li><li class="archive-list-item"><a class="archive-list-link" href="/home/thrusday/workspace/makohill.github.io/public/archives/2014/12/">December 2014</a></li><li class="archive-list-item"><a class="archive-list-link" href="/home/thrusday/workspace/makohill.github.io/public/archives/2014/10/">October 2014</a></li><li class="archive-list-item"><a class="archive-list-link" href="/home/thrusday/workspace/makohill.github.io/public/archives/2014/01/">January 2014</a></li><li class="archive-list-item"><a class="archive-list-link" href="/home/thrusday/workspace/makohill.github.io/public/archives/2013/07/">July 2013</a></li><li class="archive-list-item"><a class="archive-list-link" href="/home/thrusday/workspace/makohill.github.io/public/archives/2012/12/">December 2012</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/home/thrusday/workspace/makohill.github.io/public/2016/04/20/Tool/多看软件使用技巧教程/">(no title)</a>
          </li>
        
          <li>
            <a href="/home/thrusday/workspace/makohill.github.io/public/2016/04/20/Tool/听/">(no title)</a>
          </li>
        
          <li>
            <a href="/home/thrusday/workspace/makohill.github.io/public/2016/04/20/geocaching/什么是地理寻宝/">(no title)</a>
          </li>
        
          <li>
            <a href="/home/thrusday/workspace/makohill.github.io/public/2016/04/20/Tool/豆瓣爱问共享资料插件/">(no title)</a>
          </li>
        
          <li>
            <a href="/home/thrusday/workspace/makohill.github.io/public/2016/04/20/Tool/自定义vim字体颜色 /">(no title)</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2016 makoshan<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/home/thrusday/workspace/makohill.github.io/public/" class="mobile-nav-link">Home</a>
  
    <a href="/home/thrusday/workspace/makohill.github.io/public/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/home/thrusday/workspace/makohill.github.io/public/fancybox/jquery.fancybox.css">
  <script src="/home/thrusday/workspace/makohill.github.io/public/fancybox/jquery.fancybox.pack.js"></script>


<script src="/home/thrusday/workspace/makohill.github.io/public/js/script.js"></script>

  </div>
</body>
</html>